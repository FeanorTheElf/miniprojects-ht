\documentclass{scrartcl}

\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{xparse}
\usepackage{geometry}
\usepackage{enumerate}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage[style=english]{csquotes}
\usepackage[language=english, backend=biber, style=alphabetic, sorting=nyt]{biblatex}

\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}

\usetikzlibrary{babel, positioning, shapes.geometric, arrows, arrows.meta}
\addbibresource{bibliography.bib}

\title{Miniproject - Elliptic Curves}
\author{Simon Pohmann}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\V}{\mathbb{V}}
\newcommand{\p}{\mathfrak{p}}
\newcommand{\Set}{\mathrm{\textbf{Set}}}
\newcommand{\Aff}{\mathrm{\textbf{Aff}}}
\newcommand{\Sch}{\mathrm{\textbf{Sch}}}
\newcommand{\Ring}{\mathrm{\textbf{Ring}}}
\newcommand{\Ab}{\mathrm{\textbf{Ab}}}
\newcommand{\Top}{\mathrm{Top}}
\newcommand{\Spec}{\mathrm{Spec}}
\newcommand{\Quot}{\mathrm{Quot}}
\newcommand{\im}{\mathrm{im}}
\renewcommand{\O}{\mathcal{O}}
\DeclareMathOperator*{\colim}{colim}
\newcommand{\notdivides}{\ \nmid \ }
\newcommand{\divides}{\ \mid \ }

\newcommand\restr[2]{{
    \left.\kern-\nulldelimiterspace
    #1
    \vphantom{\big|}
    \right|_{#2}
}}

\theoremstyle{definition}

\newtheorem{prop}[subsection]{Proposition}
\newtheorem{theorem}[subsection]{Theorem}
\newtheorem{lemma}[subsection]{Lemma}
\newtheorem{corollary}[subsection]{Corollary}

\newtheorem{problem}[subsection]{Problem}
\newtheorem{alg}[subsection]{Algorithm}
\newtheorem{definition}[subsection]{Definition}
\newtheorem{example}[subsection]{Example}
\newtheorem{remark}[subsection]{Remark}

\begin{document}
\maketitle

\section{Question 1}

\begin{example}[1(i)]
    Have
    \begin{equation*}
        |162^2 + 6|_5 = |26250|_5 = |5^4 \cdot 7 \cdot 2 \cdot 3|_5 = 5^{-4} < 5^{-3}
    \end{equation*}
\end{example}

\begin{example}[1(ii)]
    Let
    \begin{equation*}
        \alpha = 5^{-1} + 2 \cdot 5^0 + 5 (1 + 4 \cdot 5) \sum_{n \geq 0} 5^{2n} \in \Q_5
    \end{equation*}
    Note that in $\Q_5$ we have
    \begin{equation*}
        \sum_{n \geq 0} 5^{2n} = \sum_{n \geq 0} 25^n = \frac 1 {1 - 25} = -\frac 1 {24}
    \end{equation*}
    So
    \begin{equation*}
        \alpha = \frac 1 5 + 2 + 5 (21) \frac 1 {24} = \frac {263} {40}
    \end{equation*}
\end{example}
For the next exercises, we will slightly abuse notation and write
\begin{equation*}
    E(R) := \{ (x, y) \in E(\bar{k}) \ | \ x, y \in R \} \cup \{\O\}
\end{equation*}
for an Elliptic Curve $E$ defined over $k$ and any ring $R$ contained in the algebraic closure $\bar{k}$.
Note that this is usually not a group anymore, and does not have a lot of nice structure.
\begin{prop}[1(iii)]
    Consider the Elliptic Curve $E: y^2 = x^3 + 2x + 2$ defined over $\Z$.
    Then $E(\Z) = \{ \O \}$ and
    \begin{equation*}
        E(\Z_p) \neq \{ \O \} \ \Leftrightarrow \ p \neq 3
    \end{equation*}
\end{prop}
\begin{proof}
    First show that there exists some $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ for all primes $p \neq 3$.

    If $p \equiv 1, 5 \mod 8$, then $-1$ is a square in $\F_p$, thus there is $\alpha \in \F_p$ with $\alpha^2 = -1$ and so $(-1, \alpha) \in \tilde{E}(\F_p)$.
    If $p \equiv 7 \mod 8$, then (by Quadratic Reciprocity) it follows that $2$ is a square in $\F_p$.
    Thus there is $\alpha \in \F_p$ with $\alpha^2 = 2$ and so $(0, \alpha) \in \tilde{E}(\F_p)$.

    Hence, consider now the case $p \equiv 3 \mod 8$.
    Note that
    \begin{equation*}
        \Delta(E) = 4 \cdot 2^3 + 27 \cdot 2^2 = 140 = 2^2 \cdot 5 \cdot 7
    \end{equation*}
    Hence we see that $p \notdivides \Delta(E)$ and so $\tilde{E}$ is an Elliptic Curve defined over $\F_p$.
    Now the Hasse bound shows that
    \begin{equation*}
        \#\tilde{E}(\F_p) \in [p + 1 - 2\sqrt{p}, p + 1 + 2\sqrt{p}]
    \end{equation*}
    Note that for $p > 9$ have $\sqrt{p} < p/3$ and thus
    \begin{equation*}
        p + 1 - 2\sqrt{p} > 4
    \end{equation*}
    Thus $\tilde{E}(\F_p) \geq 5$ and so there must be $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$, as there are at most four points on $\tilde{E}(\F_p)$ that do not satisfy this ($\O$ and possibly $(\alpha_i, 0)$ with $\alpha_i$ a root of $x^3 + 2x + 2$).

    Now consider any prime $p \neq 2, 3$ and $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z$.
    Let $f(t) := t^2 - x^3 - 2x - 2$.
    Then
    \begin{equation*}
        |f(y)|_p \leq p^{-1} \quad \text{and} \quad |f'(y)|_p = |y|_p = 1
    \end{equation*}
    Thus $|f(y)|_p < |f'(y)|_p^2$ and Hensel's Lemma yields a root $\gamma \in \Z_p$ with $(x, \gamma) \in E(\Z_p)$.

    In the case $p = 2$, note that $f(t) := t^2 - 5^3 - 2 \cdot 5 - 2 = t^2 - 137$ satisfies
    \begin{equation*}
        |f(1)|_2 = |-136|_2 = |-17 \cdot 2^3|_2 = 2^{-3} < \left( 2^{-1} \right)^2 = |2|_2^2 = |f'(1)|_2^2
    \end{equation*}
    and so Hensel's Lemma yields a point $(5, \gamma) \in E(\Z_2)$.

    The only remaining case is $p = 3$, and a trying all 9 points in $\F_3^2$ shows that $\tilde{E}(\F_3) = \{\O\}$.
    This clearly shows that $E(\Z_3) = \{ \O \}$ and so $E(\Z) = \{\O\}$.
\end{proof}
For the next exercise, we first summarize the techniques we have used above.
\begin{prop}
    \label{prop:p_adic_points_techniques}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve defined over $\Z$.
    Let $p$ be a prime.
    Then
    \begin{itemize}
        \item If $E(\Z_p) \neq \{\O\}$ then $\tilde{E}(\F_p) \neq \{\O\}$.
        \item Suppose $p \neq 2$. There is $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ if and only if there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
        \item Suppose $p \neq 2$. If $\#\tilde{E}(\F_p) \geq 5$ then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
        \item Suppose $p \geq 11$ and $p \notdivides \Delta(E)$. Then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
    \end{itemize}
\end{prop}
\begin{proof}
    The first part is trivial and follows from the fact that any $(x, y) \in E(\Z_p)$ yields $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p)$.

    For the second part, note that by assumption, there is $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z$ with $|y|_p = 1$ and so
    \begin{equation*}
        |y^2 - x^3 - a_2 x^2 - a_4 x - a_6|_p \leq p^{-1} < 1 = 1^2 = |2y|_p
    \end{equation*}
    Hensel's Lemma now shows that there is $\gamma \in \Z_p$ such that $\gamma^2 = x^3 + a_2 x^2 + a_4 x + a_6$ and so $(x, \gamma) \in E(\Z_p)$.
    Since $|y|_p = 1$ clearly also $|\gamma|_p = 1$.
    The other direction is obvious and follows directly by taking the reduction modulo $p$.

    For the third part, notice that there are at most three different points $(x, y) \in \tilde{E}(\F_p)$ with $y = 0$, as in this case $x$ is a root of the cubic $t^3 + a_2 t^2 + a_4 t + a_6$.
    Thus, if $\#\tilde{E}(\F_p) \geq 5$, there must be $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ and so the claim follows by the second part.

    For the fourth part, note that as above, $p > 9$ implies $\sqrt{p} < p/3$ and so the Hasse bound yields (since $\tilde{E}$ is an Elliptic Curve by assumption, as $p \notdivides \Delta(E)$)
    \begin{equation*}
        \#\tilde{E}(\F_p) \geq p + 1 - 2\sqrt{p} > 4
    \end{equation*}
    thus $\#\tilde{E}(\F_p) \geq 5$. 
    The claim now follows by the third part.
\end{proof}
This already shows that we do not have to worry to much about the condition $E(\Z_p) \neq \{\O\}$ for $p \neq 2, 3, 5, 7$ prime, as we expect that it is fulfilled quite often.
This gives the following condition.
\begin{prop}
    Let $f_0, f_1, f_2 \in \Z$ and consider the Elliptic Curve $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$.
    Let $p \in \{3, 5, 7\}$.
    Then there is no $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ if and only if
    \begin{align*}
        p = 3 \ \Rightarrow \ n^3 + f_2 n^2 + f_1 n + f_0 &\equiv 0, 2 \mod 3 \\
        p = 5 \ \Rightarrow \ n^3 + f_2 n^2 + f_1 n + f_0 &\equiv 0, 2, 3 \mod 5 \\
        p = 7 \ \Rightarrow \ n^3 + f_2 n^2 + f_1 n + f_0 &\equiv 0, 3, 5, 6 \mod 7
    \end{align*}
    for all $n \in \Z$.
    
    In particular, this is necessary for $E$ to satisfy the desired properties, i.e. there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ if and only if $p \neq 3, 5, 7$
    \footnote{I understood the task here to be ``if and only if''. As mentioned later, this interpretation is probably wrong, and I will discuss the other case next.}.
\end{prop}
\begin{proof}
    Let $p \in \{3, 5, 7\}$.
    Assume there is some $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z$ with $\tilde{y} \neq 0$.
    Then have
    \begin{equation*}
        y^2 \equiv x^3 + f_2 x^2 + f_1 x + f_0 \mod p
    \end{equation*}
    and so $x^3 + f_2 x^2 + f_1 x + f_0$ is a quadratic residue modulo $p$.
    
    By checking all elements in $\F_3$, $\F_5$ and $\F_7$, one finds
    \begin{align*}
        \text{$n$ quadratic residue modulo $3$} \ &\Leftrightarrow \ n \equiv 0, 1 \mod 3 \\
        \text{$n$ quadratic residue modulo $5$} \ &\Leftrightarrow \ n \equiv 0, 1, 4 \mod 5 \\
        \text{$n$ quadratic residue modulo $7$} \ &\Leftrightarrow \ n \equiv 0, 1, 4, 2 \mod 7
    \end{align*}
    Except for $n \equiv 0 \mod p$, these cases have been excluded by assumption.
    However we assumed that $y \not\equiv 0 \mod p$, so $y^2 \not\equiv 0 \mod p$ and the claim follows.

    The other direction follows by reversing the above computation.
    The claim now follows from Proposition~\ref{prop:p_adic_points_techniques}.
\end{proof}
However, there is one problem here.
Using a computer, one can easily find (e.g. by trying all possibilities) that there are no $f_0, f_1, f_2 \in \Z$ such that the above conditions are (simultaneously) fulfilled for $3$, $5$ and $7$.
This seems to indicate that I have indeed misunderstood the task, and we only look for Elliptic Curves $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ such that there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ for every $p \neq 3, 5, 7$, and do not require further properties for $E(\Z_3), E(\Z_5)$ and $E(\Z_7)$.

So instead consider a strengthening of the last part of Proposition~\ref{prop:p_adic_points_techniques}.
\begin{prop}
    \label{prop:points_in_EZp}
    Let $p \geq 11$ be a prime and $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ an Elliptic Curve with $f_0, f_1, f_2 \in \Z$.
    Then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
\end{prop}
\begin{proof}
    If $p \geq 11$ and $p \notdivides \Delta(E)$ then $\tilde{E}$ is an Elliptic Curve over $\F_p$ and the claim follows from Proposition~\ref{prop:p_adic_points_techniques}.
    
    So assume now that $p \divides \Delta(E)$, hence $x^3 + f_2 x^2 + f_1 x + f_0$ factors as
    \begin{equation*}
        x^3 + \tilde{f}_2 x^2 + \tilde{f}_1 x + \tilde{f}_0 \equiv (x - \alpha)^2(x - \beta)
    \end{equation*}
    with $\alpha, \beta \in \bar{\F}_p$.
    However, note that $\F_p$ is perfect, so $(x - \alpha)^2(x - \beta)$ cannot be irreducible over $\F_p$, otherwise $\F_p[x] / \langle(x - \alpha)^2(x - \beta)\rangle$ would be a non-separable field extension of $\F_p$.
    Thus, either $\alpha \in \F_p$ or $\beta \in \F_p$.
    If $\alpha \in \F_p$, then clearly also $\beta = -2\alpha - \tilde{f}_2 \in \F_p$.
    If $\beta \in \F_p$, then also $(x - \alpha)^2 \in \F_p[x]$ and again by perfectness of $\F_p$, note that $\alpha \in \F_p$.
    So $\alpha, \beta \in \F_p$.

    Now note that for $t \in \F_p$ have
    \begin{equation*}
        \left( t^2 + \beta, \ t (t^2 + \beta - \alpha) \right) \in \tilde{E}
    \end{equation*}
    Hence, we find a function
    \begin{equation*}
        \phi: \F_p \to \tilde{E}(\F_p) \setminus \{\O\}, \quad t \mapsto \left( t^2 + \beta, \ t (t^2 + \beta - \alpha) \right)
    \end{equation*}
    If there is $\gamma \in \F_p$ with $\gamma^2 = \alpha - \beta$, then 
    \begin{equation*}
        \restr{\phi}{\F_p \setminus \{-\gamma\}}: \F_p \setminus \{-\gamma\} \to \tilde{E}(\F_p)
    \end{equation*}
    is injective, otherwise $\phi$ is injective.
    Hence, we see that $\#(\tilde{E}(\F_p) \setminus \{\O\}) \geq \#\F_p - 1 \geq 4$ and so $\#\tilde{E}(\F_p) \geq 5$.
    It follows that there is $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p)$ with $\tilde{y} \neq 0$.
    By a Hensel-lifting argument as in Proposition~\ref{prop:p_adic_points_techniques}, we now see that there is $\gamma \in \Z_p$ with $(x, \gamma) \in E(\Z_p)$ and $|\gamma|_p = 1$.
\end{proof}
The above proposition shows that constructing Elliptic Curves $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ such that there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ for all primes $p \neq 3, 5, 7$ is indeed quite simple, as almost all curves satisfy this.
This only case that can fail is $p = 2$, but here, the condition is fulfilled quite often, so we can just try different choices.
\begin{example}
    Let
    \begin{align*}
        E_1: \ &y^2 = x^3 + 2 x \\
        E_2: \ &y^2 = x^3 + 2 x^2 + 6 x + 5\\
        E_3: \ &y^2 = x^3 + 6x + 1
    \end{align*}
    Note that
    \begin{align*}
        1^2 &\equiv 3^3 + 2 \cdot 3 = 33 \mod 8 \\
        1^2 &\equiv 2^3 + 2 \cdot 2^2 + 6 \cdot 2 + 5 = 33 \mod 8 \\
        1^2 &\equiv 4^3 + 6 \cdot 4 + 1 = 89 \mod 8
    \end{align*}
    so Hensel's Lemma yields points $(x, y) \in E_i(\Z_2)$ with $|y|_2 = 1$ for $i \in \{1, 2, 3\}$.
    By Proposition~\ref{prop:points_in_EZp}, we have points $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ for all $p \geq 11$.

    Finally, note that trying all points shows
    \begin{align*}
        \tilde{E}_1(\F_3) &= \{ (0, 0), (1, 0), (2, 0), \O \} \\
        \tilde{E}_1(\F_5) &= \{ (0, 0), \O \} \\
        \tilde{E}_2(\F_7) &= \{ (1, 0), (5, 0), (6, 0), \O \}
    \end{align*}
    so there is no point $(x, y) \in E_i(\Z_p)$ with $|y|_p = 1$ for $p \in \{3, 5, 7\}$ and a suitable $i$. 
\end{example}

\section{Question 2}
\begin{example}[2(i)]
    Consider the Elliptic Curve $E: y^2 = x(x + 1)(x + 4)$ defined over $\Q$.
    Have
    \begin{equation*}
        x(x + 1)(x + 4) = x^3 + 5x^2 + 4x = \left( x + \frac 5 3 \right)^3 - \frac {13} 3 \left( x + \frac 5 3 \right) + \frac {70} {27}
    \end{equation*}
    So $E$ is isomorphic to $E': y^2 = x^3 - \frac {13} 3 x + \frac {70} {27}$ via
    \begin{equation*}
        \psi: E \to E', \quad (x, y) \mapsto \left( x + \frac 5 3, y \right)
    \end{equation*}
    This isomorphism preserves the group structure\footnote{It is a general result that all isogenies are group homomorphisms, but in this case, it is also directly obvious as the isomorphism is linear, hence maps lines to lines.}, and so $E'_{\mathrm{tors}} \cong E_{\mathrm{tors}}$.
    Have
    \begin{equation*}
        \Delta(E') = 4 \left( -\frac {13} 3 \right)^3 + 27 \left( \frac {70} {27} \right)^2 = -144 = \Delta(E)
    \end{equation*}
    Consider now any prime $p \neq 2, 3$.
    Then the isomorphism $\psi: E \to E'$ induces an isomorphism $\tilde{\psi}: \tilde{E} \to \tilde{E}'$ between the reductions modulo $p$.
    Note that $\tilde{E}, \tilde{E}'$ are still Elliptic Curves.

    Hence, we can use results from the lecture on the reduction modulo $p \neq 2, 3$ for the curve $E$, even though it is not given by an equation of the form $y^2 = x^3 + Ax + B$, as all these statements are preserved under isomorphism.
    In particular, we see that the kernel of reduction $E_1(\Q_5)$ has no torsion and so there is an embedding
    \begin{equation*}
        E_{\mathrm{tors}}(\Q) \hookrightarrow \tilde{E}(\F_5)
    \end{equation*}
    Note that
    \begin{equation*}
        \tilde{E}(\F_5) = \{ (0, 0), (1, 0), (2, 1), (2, 4), (3, 2), (3, 3), (4, 0), \O \}
    \end{equation*}
    has order 8.
    Clearly
    \begin{equation*}
        (0, 0), (-1, 0), (-4, 0), \O \in E_{\mathrm{tors}}(\Q)
    \end{equation*}
    So the only remaining question is whether this is all the torsion (i.e. $\#E_{\mathrm{tors}}(\Q) = 4$) or there are more points (i.e. $\#E_{\mathrm{tors}}(\Q) = 8$).

    Consider now $P = (-2, 2) \in E$.
    The tangent at $P$ is given by $y = -x$ and the third point of intersection with $E$ is thus $(0, 0)$.
    Hence $P + P = (0, 0)$ and so $[4]P = \O$.
    It follows that $\#E_{\mathrm{tors}}(\Q) = 8$ and furthermore that 
    \begin{equation*}
        E_{\mathrm{tors}}(E) = \langle P, (-1, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}
\end{example}
\begin{example}[2(ii)]
    \label{ex:2ii}
    Consider the Elliptic Curve $E: y^2 = x(x + 1)(x - 8)$.
    Note that we have an isomorphism
    \begin{equation*}
        \psi: E \to E', \quad (x, y) \mapsto \left( x - \frac 7 3, y \right)
    \end{equation*}
    to the Elliptic Curve $E': y^2 = x^3 - \frac {73} 3 x - \frac {1190} {27}$ defined over $\Q$.
    Have that
    \begin{equation*}
        \Delta(E) = -72^2 = -5184 = \Delta(E')
    \end{equation*}
    Note that this has only the prime factors $2$ and $3$.
    As before, this shows that all the results from the lecture on the reduction modulo $p \neq 2, 3$ are also valid for the curve $E$, even though it is not defined by an equation of the form $y^2 = x^3 + Ax + B$.
    We see that
    \begin{equation*}
        \tilde{E}(\F_7) = \{ (0, 0), (1, 0), (4, 2), (4, 5), (5, 1), (5, 6), (6, 0), \O \}
    \end{equation*}
    and thus has order 8.
    As before, we this only leaves two possible cases, either the obvious 2-torsion points are all torsion points (i.e. $\#E_{\mathrm{tors}}(\Q) = 4$) or each of the points $\tilde{E}(\F_5)$ lifts to a torsion point (i.e. $\#E_{\mathrm{tors}}(\Q) = 8$).

    Unlike the previous example however, this time the former is the case.
    To see this, we use the Nagell-Lutz theorem.
    Assume $(x, y) \in E_{\mathrm{tors}}(\Q)$ with $y \neq 0$.
    Then it yields that $y^2 \divides \Delta(E) = -72^2$ and so $y \divides 72$.
    So
    \begin{equation*}
        y \in \{ \pm 1, \pm 2, \pm 4, \pm 8, \pm 3 \pm 6, \pm 12, \pm 24, \pm 9, \pm 18, \pm 36, \pm 72 \}
    \end{equation*}
    Furthermore $y \not\equiv 0 \mod 7$ and since $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_7)$, it follows that
    \begin{equation*}
        (\tilde{x}, \tilde{y}) \in \{ (4, \pm 2), (5, \pm 1) \} \ \Rightarrow \ \tilde{y} \in \{ \pm 1, \pm 2 \}
    \end{equation*}
    Thus we only have the possibilities
    \begin{equation*}
        y \in \{ \pm 1, \pm 2, \pm 8, \pm 6, \pm 12, \pm 9, \pm 36, \pm 72 \}
    \end{equation*}
    Furthermore, observe that
    \begin{equation*}
        \tilde{E}(\F_{11}) = \{ (0, 0), (5, 3), (5, 8), (6, 2), (6, 9), (8, 0), (10, 0), \O \}
    \end{equation*}
    and so it follows by the same argument that
    \begin{equation*}
        \tilde{y} \in \{ \pm 2, \pm 3 \}
    \end{equation*}
    This further restricts the possibilities to
    \begin{equation*}
        y \in \{ \pm 2, \pm 8, \pm 12, \pm 9 \}
    \end{equation*}
    Finally, observe that none of the equations
    \begin{align*}
        4 &= x^3 - 7x^2 - 8x \\
        64 &= x^3 - 7x^2 - 8x \\
        144 &= x^3 - 7x^2 - 8x \\
        81 &= x^3 - 7x^2 - 8x
    \end{align*}
    has a solution in $\Q$.
    To see this, use e.g. the rational root theorem and some computation:

    The only factors of $4$ are $\pm 1, \pm 2, \pm 4$ and none solves $4 = x^3 + 7x^2 - 8x$.
    The only factors of $64$ are $\pm 1, \pm 2, \pm 4, \pm 8, \pm 16, \pm 32, \pm 64$ and none solves $64 = x^3 - 7x^2 - 8x$.
    The only factors of $144$ are $\pm 1, \pm 2, \pm 4, \pm 8, \pm 16, \pm 3, \pm 6, \pm 12, \pm 24, \pm 48, \pm 9, \pm 18, \pm 36, \pm 72, \pm 144$ and none solves $144 = x^3 - 7x^2 - 8x$.
    The only factors of $81$ are $\pm 1, \pm 3, \pm 9, \pm 27, \pm 81$ and none solves $81 = x^3 - 7x^2 - 8x$.

    Note that the usual approach to bound the size of $E_{\mathrm{tors}}(\Q)$ is use to the theorem that this embeds into $\tilde{E}(\F_p)$ whenever $\tilde{E}$ is an Elliptic Curve.
    However, for this example, this was not sufficient, as we could not find a prime such that the group $\Z/4\Z \oplus \Z/2\Z$ does not embed into $\tilde{E}(\F_p)$.
    In the next part, we want to study this phenomenon more carefully and indeed see that there is no such prime, i.e. it is impossible to show that $\#E_{\mathrm{tors}}(\Q) \neq 8$ by just considering the reductions modulo $p$.
\end{example}
First, it is convenient to have a closed formula for the $x$-coordinate of $[2]P$ for a point $P$ on an Elliptic Curve.
\begin{prop}[Duplication Formula]
    \label{prop:duplication_formula}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve over a field $k$.
    For a point $P \in E$ with $P \neq \O$ denote by $x(P)$ its (affine) $x$-coordinate.
    Then have for all $P \in E$ with $P \neq -P$ that
    \begin{equation*}
        x([2]P) = \frac {x(P)^4 - 2a_4 x(P)^2 - 8a_6x(P) + a_4^2 - 4a_2a_6} {4(x(P)^3 + a_2 x(P)^2 + a_4 x(P) + a_6)}
    \end{equation*}  
\end{prop}
\begin{prop}
    Let $E: y^2 = x(x + 1)(x - 8)$ be the Elliptic Curve from the previous example.
    The for each prime $p \geq 5$, have that $\Z/4\Z \oplus \Z/2\Z$ is a subgroup of $\tilde{E}(\F_p)$.
\end{prop}
\begin{proof}
    First of all, note that the duplication formula from Proposition~\ref{prop:duplication_formula} has the form
    \begin{equation*}
        x([2]P) = \frac {x(P)^4 + 16 x(P) + 64} {4 x(P)^3 - 28 x(P)^2 - 32 x(P)}
    \end{equation*}
    Consider any prime $p \geq 5$.

    \paragraph{Case 1} If $-1$ is a quadratic residue modulo $p$, then there is $\beta \in \F_p$ with $\beta^2 = -36$.
    Have then that $(2, \beta) \in \tilde{E}(\F_p)$ and
    \begin{equation*}
        x([2](2, \beta)) = \frac {2^4 + 16 \cdot 2^2 + 64} {4 \cdot 2^3 - 28 \cdot 2^2 - 32 \cdot 2} = \frac {144} {-144} = -1
    \end{equation*}
    and so $[2](2, \beta) = (-1, 0)$ is a 2-torsion point.
    Thus $(2, \beta)$ has order $4$ and we see that
    \begin{equation*}
        \langle (2, \beta), (0, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    \paragraph{Case 2} If $-2$ is a quadratic residue modulo $p$, then there is $\alpha \in \F_p$ with $\alpha^2 = -8$.
    Then
    \begin{equation*}
        (\alpha - 8)^2 = (\alpha^2 + \alpha)(\alpha - 8) = \alpha(\alpha + 1)(\alpha - 8)
    \end{equation*}
    With $\beta := \alpha - 8$ we now find $(\alpha, \beta) \in \tilde{E}(\F_p)$ and
    \begin{equation*}
        x([2](\alpha, \beta)) = \frac {\alpha^4 + 16 \alpha^2 + 64} {4 \alpha^3 - 28 \alpha^2 - 32 \alpha} = \frac {(\alpha^2 + 8)^2} {4 \alpha^3 - 28 \alpha^2 - 32 \alpha} = 0
    \end{equation*}
    and so $[2](\alpha, \beta) = (0, 0)$ is a 2-torsion point.
    Hence, $(\alpha, \beta)$ has order $4$ and thus
    \begin{equation*}
        \langle (\alpha, \beta), (-1, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    \paragraph{Case 3} If $2$ is a quadratic residue modulo $p$, then there is $\alpha' \in \F_p$ with $(\alpha')^2 = 72$ and so there is $\alpha = \alpha' + 8$ with $\alpha^2 - 16\alpha - 8 = 0$.
    Note that $\alpha^2 = 16\alpha + 8$ and thus
    \begin{equation*}
        (9\alpha - 24)^2 = 81 \cdot 16 \alpha + 81 \cdot 8 - 432 \alpha + 576 = 1224 + 864\alpha = \alpha^3 - 7\alpha^2 - 8\alpha= \alpha (\alpha + 1) (\alpha - 8)
    \end{equation*}
    With $\beta := 9\alpha - 24$ we now find $(\alpha, \beta) \in \tilde{E}(\F_p)$ and
    \begin{align*}
        x([2](\alpha, \beta)) =& \frac {\alpha^4 + 16 \alpha^2 + 64} {4\alpha^3 - 28\alpha^2 - 32\alpha} = \frac {(\alpha^2 + 8)^2} {4\alpha(\alpha + 1)(\alpha - 8)} \\
        =& \frac {16^2(\alpha + 1)^2} {4\alpha(\alpha + 1)(\alpha - 8)} = \frac {64 (\alpha + 1)} {(\alpha^2 - 8\alpha)} = \frac {64 (\alpha + 1)} {16\alpha + 8 - 8\alpha} = 8
    \end{align*}
    and so $[2](\alpha, \beta) = (8, 0)$ is a 2-torsion point.
    Hence $(\alpha, \beta)$ has order $4$ and thus
    \begin{equation*}
        \langle (\alpha, \beta), (0, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    Since the Legendre symbol is multiplicative and $(-2)(-1) = 2$, these cases are exhaustive.
\end{proof}
To find more examples, it might be a good idea to use the structure from the previous theorem, but take another set of exhaustive cases.
So consider an Elliptic Curve
\begin{equation*}
    E: y^2 = x(x - \alpha)(x - \beta) = x^3 - (\alpha + \beta)x^2 + \alpha \beta x
\end{equation*}
with 3 nontrivial torsion points $(\alpha, 0), (\beta, 0), (0, 0)$ over $\Q$.
We study in which cases there is some $P \in \tilde{E}(\F_p)$ of order 4.
\begin{lemma}
    Let $E: y^2 = x(x - \alpha)(x - \beta)$ be an Elliptic Curve over a field $k$ of characteristic $\neq 2$.
    Then there exists $P \in E(k)$ of order 4 if and only if $k$ has a root of the polynomial $F(T)$ given by
    \begin{equation*}
        \left(T^4 + 2(\alpha + \beta)T^2 + (\alpha - \beta)^2\right)\left(T^4 + (2\beta - 4\alpha)T^2 + \beta^2\right)\left(T^4 + (2\alpha - 4\beta)T^2 + \alpha^2\right)
    \end{equation*}
\end{lemma}
\begin{proof}
    The duplication formula for $E$ gives with $x = x(P)$ that
    \begin{equation*}
        x([2]P) = d(x) := \frac {x^4 - 2 \alpha \beta x^2 + \alpha^2 \beta^2} {4x^3 - 4(\alpha + \beta) x^2 + 4 \alpha \beta x}
    \end{equation*}

    \paragraph{Case 1} If there is $\mu \in \F_p$ with $\mu^4 + 2(\alpha + \beta)\mu^2 + (\alpha - \beta)^2 = 0$.

    Then note that there is $\gamma := \frac 1 2 (\mu^2 - \alpha - \beta)$ such that $\gamma^2 = \alpha\beta$.
    Thus
    \begin{equation*}
        d(\gamma) = \frac {\gamma^4 - 2\alpha\beta\gamma^2 + \alpha^2\beta^2} {4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma} = \frac 0 {4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma} = 0
    \end{equation*}
    Note further that
    \begin{equation*}
        \gamma^3 - (\alpha + \beta)\gamma^2 + \alpha\beta\gamma = 2\alpha\beta\gamma - \alpha\beta(\alpha + \beta) = \alpha\beta(2\gamma - \alpha - \beta) = \gamma^2 \mu^2
    \end{equation*}
    since $\mu^2 = 2\gamma - \alpha - \beta$.
    So there is a point $(\gamma, \gamma\mu) \in E(k)$ with $[2](\gamma, \mu) = (0, 0)$.

    \paragraph{Case 2} If there is $\mu \in k$ with $\mu^4 + (2\beta - 4\alpha)\mu^2 + \beta^2 = 0$.

    Then note that there is $\gamma := \frac 1 2 (\mu^2 + \beta)$ such that $\gamma^2 - 2\alpha\gamma + \alpha\beta = 0$.
    Thus
    \begin{align*}
        &\gamma^4 - 2 \alpha \beta \gamma^2 + \alpha^2 \beta^2 = 4\alpha \gamma^3 - 4\alpha(\alpha + \beta) \gamma^2 + 4 \alpha^2 \beta \gamma \\
        =& \gamma^4 - 4\alpha \gamma^3 + (4\alpha^2 + 4\alpha\beta - 2\alpha\beta)\gamma^2 - 4\alpha^2\beta \gamma + \alpha^2\beta^2 \\
        =& \gamma^4 - 4\alpha \gamma^3 + 2\alpha(2\alpha + \beta)\gamma^2 - 4\alpha^2\beta \gamma + \alpha^2\beta^2 \\
        =& (\gamma^2 - 2\alpha \gamma + \alpha \beta)^2 = 0^2 = 0
    \end{align*}
    and so
    \begin{equation*}
        \gamma^4 - 2 \alpha \beta \gamma^2 + \alpha^2 \beta^2 = \alpha(4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma)
    \end{equation*}
    It follows that
    \begin{equation*}
        d(\gamma) = \frac {\gamma^4 - 2 \alpha \beta \gamma^2 + \alpha^2 \beta^2} {4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma} = \alpha
    \end{equation*}
    Furthermore note that
    \begin{align*}
        \gamma^3 - (\alpha + \beta)\gamma^2 + \alpha\beta\gamma =& \gamma(2\alpha\gamma - \alpha\beta) - (2\alpha\gamma - \alpha\beta)(\alpha + \beta) + \alpha\beta\gamma \\
        =& 2\alpha(2\alpha\gamma - \alpha\beta) - 2\alpha^2\gamma - 2\alpha\beta\gamma + \alpha^2\beta + \alpha\beta^2 \\
        =& \gamma(4\alpha^2 - 2\alpha^2 - 2\alpha\beta) + \alpha^2\beta + \alpha\beta^2 - 2\alpha^2\beta \\
        =& 2\alpha\gamma(\alpha - \beta) + \alpha\beta(\beta - \alpha) \\
        =& \alpha(\alpha - \beta)(2\gamma - \beta) \\
        =& (\gamma - \alpha)^2\mu^2
    \end{align*}
    as $\mu^2 = 2\gamma - \beta$ and $(\gamma - \alpha)^2 = 2\alpha\gamma - \alpha\beta - 2\gamma\alpha + \alpha^2 = \alpha(\alpha - \beta)$.
    So there is a point $(\gamma, (\gamma - \alpha)\mu) \in E(k)$ with $[2](\gamma, (\gamma - \alpha)\mu) = (\alpha, 0)$.

    \paragraph{Case 3} Similarly, if there is $\mu \in k$ with $\mu^4 + (2\alpha - 4\beta)\mu^2 + \alpha^2 = 0$, then there is a point $P \in E(k)$ with $[2]P = (\beta, 0)$
\end{proof}
Hence, we just have to find $\alpha, \beta \in \Q$ such that the polynomial $F$ has no root in $\Q$ and a root in every $\F_p$ (where $p$ is a prime of good reduction).
First, note that $F(T) = G(T^2)$ where
\begin{equation*}
    G(T) = \left( T^2 + 2(\alpha + \beta)T + (\alpha - \beta)^2 \right)\left( T^2 + (2\beta - 4\alpha)T + \beta^2 \right)\left( T^2 + (2\alpha - \beta)T + \alpha^2 \right)
\end{equation*}
Since the cases where this has a root in $\Q$ are clearly a Zariski-closed condition on $(\alpha, \beta)$, we see that ``most'' value of $\alpha, \beta$ will result in no root of $F(T)$.
Hence, we focus on finding $\alpha, \beta \in \Z$ such that $F(T)$ has a root modulo any prime $p$ (of good reduction).
A necessary condition for that is that $G(T)$ has a root modulo any prime $p$, which in turn is equivalent that any of the discriminants (scaled by squares)
\begin{equation*}
    \alpha\beta, \ (\alpha - 3\beta)(\alpha - \beta), \ (\beta - 3\alpha)(\beta - \alpha)
\end{equation*}
is a quadratic residue modulo $p$, for any prime $p$.

\section{Question 3}
\begin{lemma}
    \label{prop:relation_y_uv}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve defined over $k$.
    Suppose that $E$ has a nontrivial 5-torsion point $P = (\alpha_1, \beta_1) \in E(k)$.
    wlog $\alpha_1 = 0$.
    Let further $(\alpha_2, \beta_2) = [2](0, \beta)$.
    Then
    \begin{equation*}
        \alpha_2^3 = -4\beta\beta_2
    \end{equation*}
\end{lemma}
\begin{proof}
    Consider the following SAGE script:
    \lstinputlisting[language = python]{./3i_algebra.sage}
    The output shows that $\alpha_2^3 = -4 \beta \beta_2$ already follows from the facts
    \begin{align*}
        &(0, \beta) \in E, \\
        &(\alpha_2, \beta_2) \in E, \\
        &[2](0, \beta) = (\alpha_2, \beta_2), \\
        &[2](\alpha_2, \beta_2) = (0, -\beta)
    \end{align*}
    which hold by assumption that $(0, \beta)$ has order $5$.
    The claim follows.
\end{proof}
\begin{lemma}
    Let
    \begin{equation*}
        E: y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2 + a_4 x + a_6    
    \end{equation*}
    and
    \begin{equation*}
        E': y^2 + a'_1 x y + a'_3 y = x^3 + a'_2 x^2 + a'_4 x + a'_6    
    \end{equation*}
    be Elliptic Curves.
    If there are five distinct points $P_1, ..., P_5 \in E \cap E'$ in ``sufficiently independent position'', then $E = E'$ (meaning $a_i = a'_i$).

    To be completely precise, there is a fixed 1-dimensional algebraic curve $C \subseteq \mathbb{A}^{10}$ (that does not depend on $E$, $E'$ or $P_1, ..., P_5$) of degree $6$ such that if there are five points $P_1 = (x_1, y_1), ..., P_5 = (x_5, y_5) \in E \cap E'$ with
    \begin{equation*}
        (x_1, ..., x_5, y_1, ..., y_5) \notin C
    \end{equation*}
    then $E = E'$.
\end{lemma}
\begin{proof}
    Consider the matrix $A = (a_{ij}) \in k[x_1, ..., x_5, y_1, ..., y_5]^{5 \times 5}$ given by
    \begin{equation*}
        a_{ij} = \begin{cases}
            x_i^{j - 1} & \text{if $j \leq 3$} \\
            -x_iy_i & \text{if $j = 4$} \\
            -y_i & \text{if $j = 5$}
        \end{cases}
    \end{equation*}
    Let $C = \V(\det(A))$ and assume there are five points $P_1 = (x_1, y_1), ..., P_5(x_5, y_5) \in E \cap E'$.
    Then the matrix $A_P := A(x_1, ..., x_5, y_1, ..., y_5) \in k^{5 \times 5}$ is regular.
    Since $P_1, ..., P_5 \in E \cap E'$, see that
    \begin{equation*}
        A_P (a_6 \ \ a_4 \ \ a_2 \ \ a_1 \ \ a_3)^T = (y_1^2 x_1^3 \ \ ... \ \ y_5^2 x_5^3)^T
    \end{equation*}
    and
    \begin{equation*}
        A_P (a'_6 \ \ a'_4 \ \ a'_2 \ \ a'_1 \ \ a'_3)^T = (y_1^2 x_1^3 \ \ ... \ \ y_5^2 x_5^3)^T
    \end{equation*}
    Thus by linear algebra, find that $E = E'$.
\end{proof}
\begin{prop}
    \label{prop:characterization_5_torsion}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve defined over $k$.
    Suppose that $E$ has a nontrivial 5-torsion point $P = (0, \beta) \in E(k)$.
    Let further $[2]P = (\alpha_2, \beta_2)$ and note that $0 \neq \alpha_2$.
    Then there exists a birational equivalence $E \to E'$ where $E': y^2 + (1 + v) x y + v y = x^3 + v x^2$ given by
    \begin{equation*}
        \psi: E \to E', \quad (x, y) \mapsto (u^2 x, u^3 y + u^2 s x + t)
    \end{equation*}
    with
    \begin{equation*}
        v = \frac {\beta_2} {\beta}, \quad t = -\frac {\beta_2} {2\beta}, \quad u = -\frac {\alpha_2} {2\beta}, \quad s = \frac {u} {\alpha_2} ( \beta_2 + \beta )
    \end{equation*}
\end{prop}
\begin{proof}
    Clearly $\psi$ maps $E$ to an Elliptic Curve $E''$.
    Note that by assumption, we have
    \begin{align*}
        &[1](0, \beta) = (0, \beta), \quad [2](0, \beta) = (\alpha_2, \beta_2), \\
        &[3](0, \beta) = -[2](0, \beta) = (\alpha_2, -\beta_2), \quad [4](0, \beta) = -[1](0, \beta) = (0, -\beta)
    \end{align*}
    By Lemma~\ref{prop:relation_y_uv} we have that $\alpha_2^3 = -4\beta\beta_2$ and so
    \begin{equation*}
        u^3 = \left( -\frac {\alpha_2} {2\beta} \right)^3 = -\frac {\alpha_2^3} {8\beta^3} = \frac {4\beta\beta_2} {8\beta^3} = \frac {\beta_2} {2\beta^2}
    \end{equation*}

    Under $\psi$, we now see that
    \begin{equation*}
        (0, \ \beta) \mapsto (0, u^3 \beta + t) = \left( 0, \ \frac {\beta} {2\beta_2} - \frac {\beta} {2\beta_2} \right) = (0, 0) \in E'
    \end{equation*}
    and
    \begin{align*}
        (\alpha_2, \ \beta_2) \mapsto (u^2 \alpha_2, \ u^3 \beta_2 + u^2 s \alpha_2 + t) &= \left(\frac {\alpha_2^3} {4\beta^2}, \ \frac {\beta_2^2} {2\beta^2} + \frac {\beta_2} {2\beta} \left( \frac {\beta_2} {\beta} + 1 \right) - \frac {\beta_2} {2\beta} \right) \\
        &= \left( -\frac {\beta_2} {\beta}, \ \frac {\beta_2^2} {\beta^2} \right) = (-v, \ v^2) \in E'
    \end{align*}
    and
    \begin{align*}
        (\alpha_2, \beta_2) \mapsto (u^2 \alpha_2, \ -u^3 \beta_2 + u^2 s \alpha_2 + t) &= \left(\frac {\alpha_2^3} {4\beta^2}, \ -\frac {\beta_2^2} {2\beta^2} + \frac {\beta_2} {2\beta} \left( \frac {\beta_2} {\beta} + 1 \right) - \frac {\beta_2} {2\beta} \right) \\
        &= ( -\frac {\beta_2} {\beta}, \ 0) = (-v, \ 0) \in E'
    \end{align*}
    and
    \begin{align*}
        (0, \ -\beta) \mapsto (0, -u^3 \beta + t) = \left( 0, \ -\frac {\beta_2} {2\beta} - \frac {\beta_2} {2\beta} \right) = (0, \ -v) \in E'
    \end{align*}
    and of course $\O \mapsto \O$.
    Hence we have $\#(E' \cap E'') \geq 5$ and by the previous proposition we see that $E' = E''$.
\end{proof}
\begin{corollary}[3(i)]
    Let $E$ be an Elliptic Curve defined over $\Q$.
    Then $E(\Q)$ has a nontrivial 5-torsion point if and only if $E$ is isomorphic (over $\Q$) to an Elliptic Curve given by an equation of the form
    \begin{equation*}
        y^2 + (v + 1)x y + v y = x^3 + v x^2
    \end{equation*}
\end{corollary}
\begin{proof}
    Note that $E$ is isomorphic (over $\Q$) to an Elliptic Curve defined by a Weierstraß equation, so assume wlog
    \begin{equation*}
        E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6
    \end{equation*}
    Now let $P = (\alpha, \beta)$ be a nontrivial 5-torsion point.
    Then $E$ is isomorphic via $(x, y) \mapsto (x - \alpha, \beta)$ to an Elliptic Curve
    \begin{equation*}
        E': y^2 = x^3 + a'_2 x^2 + a'_4 x
    \end{equation*}
    and $(0, \beta)$ is a nontrivial 5-torsion point of $E'$.
    The claim follows now by Proposition~\ref{prop:characterization_5_torsion}.

    Conversely, assume that
    \begin{equation*}
        E: y^2 + (v + 1) x y + v y = x^3 + v x^2
    \end{equation*}
    For example by the duplication formula~\ref{prop:duplication_formula} find that
    \begin{equation*}
        [2](0, 0) = (-v, v^2), \quad [2](-v, v^2) = (0, -v)
    \end{equation*}
    and thus $[4](0, 0) + (0, 0) = \O$, hence $(0, 0)$ has order 5.
\end{proof}
In the lecture, it was mentioned that a theorem of Mazur states that the torsion group of an Elliptic Curve $E$ defined over $\Q$ has one of the following forms
\begin{itemize}
    \item $\Z/n\Z$ for $n \in \{ 1, ..., 10, 12 \}$
    \item $\Z/n\Z \oplus \Z/2\Z$ for $n \in \{ 2, 4, 6, 8 \}$
\end{itemize}
Hence, we are quite limited for $N$ a similar idea can work.
First, note that the case $N = 2$ is easy.
\begin{prop}[3(ii)]
    Let $E$ be an Elliptic Curve defined over $\Q$.
    Then $E(\Q)$ has a nontrivial 2-torsion point if and only if $E$ is isomorphic (over $\Q$) to an Elliptic Curve given by an equation of the form
    \begin{equation*}
        y^2 = x^3 + a_2 x^2 + a_4 x
    \end{equation*}
\end{prop}
\begin{proof}
    Assume $E: y^2 = x^3 + a_2 x^2 + a_4 x$ is an Elliptic Curve.
    Then clearly $(0, 0) \in E(\Q)$ and $(0, 0) = -(0, 0)$, so $(0, 0)$ is nontrival 2-torsion point.
    Hence, there is a nontrivial 2-torsion point in $E'(\Q)$ for all Elliptic Curves $E'$ that are isomorphic (over $\Q$) to $E$.

    Conversely, let $E$ be an Elliptic Curve with a nontrivial 2-torsion point in $E(\Q)$.
    Note that $E$ is isomorphic to an Elliptic Curve 
    \begin{equation*}
        E': y^2 = x^3 + a_2 x^2 + a_4 x + a_6
    \end{equation*}
    as this holds for every Elliptic Curve.
    Now let $(\alpha, \beta) \in E'(\Q)$ be a nontrival 2-torsion point.
    Thus $-(\alpha, \beta) = (\alpha, \beta)$, so $\beta = 0$ and $\alpha^3 + a_2 \alpha^2 + a_4 \alpha + a_6 = 0$.
    Now consider the isomorphism
    \begin{equation*}
        E' \to E'', \quad (x, y) \mapsto (x - \alpha, y)
    \end{equation*}
    where
    \begin{equation*}
        E'': y^2 = x^3 + (3\alpha + a_2) x^2 + (3\alpha^2 + 2\alpha a_2 + a_4)x + \underbrace{\alpha^3 + \alpha^2a_2 + \alpha a_4 + a_6}_{= 0}
    \end{equation*}
    Observe that $E''$ is of the described form, and the claim follows. 
\end{proof}
The case $N = 3$ is slightly more interesting.
For this, we first look at some basic transformations we can do to Weierstraß equations.
\begin{prop}
    \label{prop:weierstrass_transformations}
    Let $E: y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve defined over $k$.
    There are three nice types of transformations
    \begin{description}
        \item[Translation] Let $P = (s, t) \in E(k)$ be a point. Then the isomorphism
        \begin{equation*}
            E \to E', \quad (x, y) \mapsto (x - s, y - t)
        \end{equation*}
        maps $P$ to $(0, 0)$ and the curve $E$ to an Elliptic Curve
        \begin{equation*}
            E': y^2 + a_1 x y + (a_3 + 2t + a_1 s) y = x^3 + (a_2 + 3 s) x^2 + (a_4 - 3 s^2 + 2 a_2 s - a_1 t) x
        \end{equation*}
        This is very useful to clear $a_6$ and continue working with the point $(0, 0)$.
        \item[Shearing] Let $r \in k$. Then the isomorphism
        \begin{equation*}
            E \to E', \quad (x, y) \mapsto (x, y - r x)
        \end{equation*}
        preserves $(0, 0)$ and maps $E$ to an Elliptic Curve
        \begin{equation*}
            E': y^2 + (a_1 + 2r) x y + a_3 y = x^3 + (a_2 + r^2 - a_1 r) x^2 + (a_4 - r a_3) x + a_6
        \end{equation*}
        This is very useful, as it does not change $a_3$ and $a_6$.
        \item[Scaling] Let $u \in k^*$. Then the isomorphism
        \begin{equation*}
            E \to E', \quad (x, y) \mapsto (u^2 x, y^3 y)
        \end{equation*}
        preserves $(0, 0)$ and maps $E$ to an Elliptic Curve
        \begin{equation*}
            E': y^2 + \frac {a_1} u x y + \frac {a_3} {u^3} = x^3 + \frac {a_2} {u^2} x^2 + \frac {a_4} {u^4} x + \frac {a_6} {u^6}
        \end{equation*}
        This is very useful, as it does not change which of the $a_1, ..., a_4, a_6$ are zero.
    \end{description}
\end{prop}
Now we can find a nice form for Elliptic Curves with a (nontrivial) 3-torsion point by the following step:
\begin{itemize}
    \item Apply a translation to get an isomorphic curve whose (nontrivial) 3-torsion point is $(0, 0)$.
    \item Observe that $(0, 0)$ being a 3-torsion point is equivalent to the fact that the tangent at $E$ through $(0, 0)$ meets $E$ at $(0, 0)$ with multiplicity three.
    \item Apply clever shearing and scaling to get a nice form. Note that this does not destroy the fact $a_6 = 0$.
\end{itemize}
Now we get
\begin{prop}
    Let $E$ be an Elliptic Curve defined over $\Q$.
    Then $E(\Q)$ has a nontrivial 3-torsion point if and only if $E$ is isomorphic (over $\Q$) to an Elliptic Curve given by an equation of the form
    \begin{equation*}
        y^2 + x y + v y = x^3
    \end{equation*}
\end{prop}
\begin{proof}
    By Proposition~\ref{prop:weierstrass_transformations} we can assume wlog that
    \begin{equation*}
        E: y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2 + a_4 x
    \end{equation*}
    and $(0, 0) \in E(\Q)$ is a nontrivial 3-torsion point.
    Now a shearing with $r = a_4 / a_3$ transforms $E$ into an Elliptic Curve
    \begin{equation*}
        E': y^2 + a'_1 x y + a'_3 y = x^3 + a'_2 x^2
    \end{equation*}
    Observe that $(0, 0)$ is still a nontrivial 3-torsion point of $E'(\Q)$.

    Now note that the tangent at $(0, 0)$ has slope $m = a'_4/a'_3 = 0$.
    Hence, since $-[2](0, 0) = (0, 0)$ is the third point of intersection of $E'$ and the tangent, we see that the tangent meets $E'$ at $(0, 0)$ with multiplicity three.
    Thus
    \begin{equation*}
        x^3 + a'_2 x^2 
    \end{equation*}
    must already be $x^3$ and thus have $a'_2 = 0$.
    Finally, apply a scaling with $u = a'_1$ (note that $a'_1 \neq 0$, otherwise the curve would be singular) and find that $E$ is isomorphic to the curve
    \begin{equation*}
        E'': y^2 + x y + v y = x^3
    \end{equation*}
    where $v = a'_3 / (a'_1)^3$.

    Conversely, assume that $E$ is isomorphic to an Elliptic Curve of the above form, so wlog
    \begin{equation*}
        E: y^2 + x y + v y = x^3
    \end{equation*}
    We show that $(0, 0) \in E(\Q)$ has order 3.
    The tangent at $(0, 0)$ has slope $0$, so is given by the line $y = 0$.
    Plugging this in yields $x^3 = 0$, and so the third point of intersection with $E$ is $(0, 0)$.
    
    Now consider the line through $\O$ and $(0, 0)$, which is given by $x = 0$.
    Plugging this in yields $y^2 + v y = 0$ and so the third point of intersection is $(0, -v)$.
    Now note that $(0, 0)$, $(0, -v)$ and $\O$ are colinear, so $(0, 0) + (0, -v) + \O = \O$, hence $(0, 0) = -[2](0, 0)$ has order 3.
\end{proof}

\section{Question 4}

\begin{example}
    The Elliptic Curve $E: y^2 = x(x + 6 + 1)$ has rank $0$.
\end{example}
\begin{proof}
    As in the lecture, consider
    \begin{align*}
        &E': y^2 = x(x^2 - 12x + 32) \\
        &\phi: E \to E', \quad (u, v) \mapsto \left( \frac {y^2} {x^2}, \ y \frac {x^2 - 1} {x^2} \right) \\
        &\hat{\phi}: E' \to E, \quad (u, v) \mapsto \left( \frac {y^2} {4x^2}, \ y \frac {x^2 - 1} {8x^2} \right) \\
        &q: E'(\Q)/\phi(E(\Q)) \to \Q^*/S, \quad \overline{(u, v)} \mapsto \begin{cases}
            \overline{u} & \text{if $u \neq 0$} \\
            \overline{32} & \text{if $u = 0$}
        \end{cases} \\
        &\hat{q}: E(\Q)/\phi(E'(\Q)) \to \Q^*/S, \quad \overline{(u, v)} \mapsto \begin{cases}
            \overline{u} & \text{if $u \neq 0$} \\
            \overline{1} & \text{if $u = 0$}
        \end{cases}
    \end{align*}
    \paragraph{Find $E'(\Q)/\phi(E(\Q))$} As in the lecture, consider $r \divides 32$ square-free, i.e. $r \in \{ \pm 1, \pm 2 \}$.

    For $r = 2$, have that $(l, m, n) = (2, 1, 0)$ solves
    \begin{equation*}
        2l^4 - 12l^2m^2 + 16m^4 = n^2
    \end{equation*}
    and indeed we find $(8, 0) \in E'(\Q)$.

    For $r = -1$, note that
    \begin{equation*}
        -l^4 - 12l^2m^2 - 32m^4 = n^2
    \end{equation*}
    has no nontrivial solutions in $\Q$, as the left-hand side is always $\leq 0$ and the right-hand side is $\geq 0$.

    Since $-2 = -1 \cdot 2$, we see that $\im(q) = \langle 2 \rangle$ and $E'(\Q)/\phi(E(\Q)) = \langle (8, 0) \rangle$.

    \paragraph{Find $E(\Q)/\hat{\phi}(E'(\Q))$} Consider $r \divides 1$, i.e. $r \in \{ \pm 1 \}$.

    For $r = -1$, have that $(l, m, n) = (1, 1, 2)$ solves
    \begin{equation*}
        -l^4 + 6l^2m^2 - m^2 = n^2
    \end{equation*}
    and indeed find $(-1, 2) \in E(\Q)$.

    Thus find $\im(\hat{q}) = \langle -1 \rangle$ and $E(\Q)/\hat{\phi}(E'(\Q)) = \langle (-1, 2) \rangle$.

    \paragraph{Find the rank of $E$} By the above two steps, we see that
    \begin{equation*}
        E(\Q)/[2]E(\Q) = \langle (-1, 2), \hat{\phi}((8, 0)) \rangle = \langle (-1, 2), (0, 0) \rangle
    \end{equation*}
    Now observe that $[2](-1, 2) = (0, 0)$ and $[2](0, 0) = \O$.
    Hence $E(\Q) = E_{\mathrm{tors}}(\Q)$ and the rank is 0 as claimed.
\end{proof}

\end{document}