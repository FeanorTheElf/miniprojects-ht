\documentclass{scrartcl}

\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{xparse}
\usepackage{geometry}
\usepackage{enumerate}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage[style=english]{csquotes}
\usepackage[language=english, backend=biber, style=alphabetic, sorting=nyt]{biblatex}

\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}

\usetikzlibrary{babel, positioning, shapes.geometric, arrows, arrows.meta}
\addbibresource{bibliography.bib}

\title{Miniproject - Elliptic Curves}
\author{Simon Pohmann}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\V}{\mathbb{V}}
\newcommand{\p}{\mathfrak{p}}
\newcommand{\Set}{\mathrm{\textbf{Set}}}
\newcommand{\Aff}{\mathrm{\textbf{Aff}}}
\newcommand{\Sch}{\mathrm{\textbf{Sch}}}
\newcommand{\Ring}{\mathrm{\textbf{Ring}}}
\newcommand{\Ab}{\mathrm{\textbf{Ab}}}
\newcommand{\Top}{\mathrm{Top}}
\newcommand{\Spec}{\mathrm{Spec}}
\newcommand{\Quot}{\mathrm{Quot}}
\newcommand{\im}{\mathrm{im}}
\renewcommand{\O}{\mathcal{O}}
\DeclareMathOperator*{\colim}{colim}
\newcommand{\notdivides}{\ \nmid \ }
\newcommand{\divides}{\ \mid \ }

\newcommand\restr[2]{{
    \left.\kern-\nulldelimiterspace
    #1
    \vphantom{\big|}
    \right|_{#2}
}}

\newtheorem{prop}{Proposition}
\newtheorem{theorem}[prop]{Theorem}
\newtheorem{lemma}[prop]{Lemma}
\newtheorem{corollary}[prop]{Corollary}

\theoremstyle{definition}
\newtheorem{problem}[prop]{Problem}
\newtheorem{alg}[prop]{Algorithm}
\newtheorem{definition}[prop]{Definition}
\newtheorem{example}[prop]{Example}
\newtheorem{remark}[prop]{Remark}

\begin{document}
\maketitle

\section{Question 1}

\begin{example}[1(i)]
    Have
    \begin{equation*}
        |162^2 + 6|_5 = |26250|_5 = |5^4 \cdot 7 \cdot 2 \cdot 3|_5 = 5^{-4} < 5^{-3}
    \end{equation*}
\end{example}

\begin{example}[1(ii)]
    Let
    \begin{equation*}
        \alpha = 5^{-1} + 2 \cdot 5^0 + 5 (1 + 4 \cdot 5) \sum_{n \geq 0} 5^{2n} \in \Q_5
    \end{equation*}
    Note that in $\Q_5$ we have
    \begin{equation*}
        \sum_{n \geq 0} 5^{2n} = \sum_{n \geq 0} 25^n = \frac 1 {1 - 25} = -\frac 1 {24}
    \end{equation*}
    So
    \begin{equation*}
        \alpha = \frac 1 5 + 2 + 5 (21) \frac 1 {24} = \frac {263} {40}
    \end{equation*}
\end{example}
For the next exercises, we will slightly abuse notation and write
\begin{equation*}
    E(R) := \{ (x, y) \in E(\bar{k}) \ | \ x, y \in R \} \cup \{\O\}
\end{equation*}
for an Elliptic Curve $E$ defined over $k$ and any ring $R$ contained in the algebraic closure $\bar{k}$.
Note that this is usually not a group anymore, and does not have a lot of nice structure.
\begin{prop}[1(iii)]
    Consider the Elliptic Curve $E: y^2 = x^3 + 2x + 2$ defined over $\Z$.
    Then $E(\Z) = \{ \O \}$ and
    \begin{equation*}
        E(\Z_p) \neq \{ \O \} \ \Leftrightarrow \ p \neq 3
    \end{equation*}
\end{prop}
\begin{proof}
    First show that there exists some $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ for all primes $p \neq 3$.

    If $p \equiv 1, 5 \mod 8$, then $-1$ is a square in $\F_p$, thus there is $\alpha \in \F_p$ with $\alpha^2 = -1$ and so $(-1, \alpha) \in \tilde{E}(\F_p)$.
    If $p \equiv 7 \mod 8$, then (by Quadratic Reciprocity) it follows that $2$ is a square in $\F_p$.
    Thus there is $\alpha \in \F_p$ with $\alpha^2 = 2$ and so $(0, \alpha) \in \tilde{E}(\F_p)$.

    Hence, consider now the case $p \equiv 3 \mod 8$.
    Note that
    \begin{equation*}
        \Delta(E) = 4 \cdot 2^3 + 27 \cdot 2^2 = 140 = 2^2 \cdot 5 \cdot 7
    \end{equation*}
    Hence we see that $p \notdivides \Delta(E)$ and so $\tilde{E}$ is an Elliptic Curve defined over $\F_p$.
    Now the Hasse bound shows that
    \begin{equation*}
        \#\tilde{E}(\F_p) \in [p + 1 - 2\sqrt{p}, p + 1 + 2\sqrt{p}]
    \end{equation*}
    Note that for $p > 9$ have $\sqrt{p} < p/3$ and thus
    \begin{equation*}
        p + 1 - 2\sqrt{p} > 4
    \end{equation*}
    Thus $\tilde{E}(\F_p) \geq 5$ and so there must be $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$, as there are at most four points on $\tilde{E}(\F_p)$ that do not satisfy this ($\O$ and possibly $(\alpha_i, 0)$ with $\alpha_i$ a root of $x^3 + 2x + 2$).

    Now consider any prime $p \neq 2, 3$ and $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z$.
    Let $f(t) := t^2 - x^3 - 2x - 2$.
    Then
    \begin{equation*}
        |f(y)|_p \leq p^{-1} \quad \text{and} \quad |f'(y)|_p = |y|_p = 1
    \end{equation*}
    Thus $|f(y)|_p < |f'(y)|_p^2$ and Hensel's Lemma yields a root $\gamma \in \Z_p$ with $(x, \gamma) \in E(\Z_p)$.

    In the case $p = 2$, note that $f(t) := t^2 - 5^3 - 2 \cdot 5 - 2 = t^2 - 137$ satisfies
    \begin{equation*}
        |f(1)|_2 = |-136|_2 = |-17 \cdot 2^3|_2 = 2^{-3} < \left( 2^{-1} \right)^2 = |2|_2^2 = |f'(1)|_2^2
    \end{equation*}
    and so Hensel's Lemma yields a point $(5, \gamma) \in E(\Z_2)$.

    The only remaining case is $p = 3$, and a trying all 9 points in $\F_3^2$ shows that $\tilde{E}(\F_3) = \{\O\}$.
    This clearly shows that $E(\Z_3) = \{ \O \}$ and so $E(\Z) = \{\O\}$.
\end{proof}
For the next exercise, we first summarize the techniques we have used above.
\begin{prop}
    \label{prop:p_adic_points_techniques}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve defined over $\Z$.
    Let $p$ be a prime.
    Then
    \begin{itemize}
        \item If $E(\Z_p) \neq \{\O\}$ then $\tilde{E}(\F_p) \neq \{\O\}$.
        \item Suppose $p \neq 2$. There is $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ if and only if there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
        \item Suppose $p \neq 2$. If $\#\tilde{E}(\F_p) \geq 5$ then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
        \item Suppose $p \geq 11$ and $p \notdivides \Delta(E)$. Then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
    \end{itemize}
\end{prop}
\begin{proof}
    The first part is trivial and follows from the fact that any $(x, y) \in E(\Z_p)$ yields $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p)$.

    For the second part, note that by assumption, there is $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z$ with $|y|_p = 1$ and so
    \begin{equation*}
        |y^2 - x^3 - a_2 x^2 - a_4 x - a_6|_p \leq p^{-1} < 1 = 1^2 = |2y|_p
    \end{equation*}
    Hensel's Lemma now shows that there is $\gamma \in \Z_p$ such that $\gamma^2 = x^3 + a_2 x^2 + a_4 x + a_6$ and so $(x, \gamma) \in E(\Z_p)$.
    Since $|y|_p = 1$ clearly also $|\gamma|_p = 1$.
    The other direction is obvious and follows directly by taking the reduction modulo $p$.

    For the third part, notice that there are at most three different points $(x, y) \in \tilde{E}(\F_p)$ with $y = 0$, as in this case $x$ is a root of the cubic $t^3 + a_2 t^2 + a_4 t + a_6$.
    Thus, if $\#\tilde{E}(\F_p) \geq 5$, there must be $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ and so the claim follows by the second part.

    For the fourth part, note that as above, $p > 9$ implies $\sqrt{p} < p/3$ and so the Hasse bound yields (since $\tilde{E}$ is an Elliptic Curve by assumption, as $p \notdivides \Delta(E)$)
    \begin{equation*}
        \#\tilde{E}(\F_p) \geq p + 1 - 2\sqrt{p} > 4
    \end{equation*}
    thus $\#\tilde{E}(\F_p) \geq 5$. 
    The claim now follows by the third part.
\end{proof}
This already shows that we do not have to worry to much about the condition $E(\Z_p) \neq \{\O\}$ for $p \neq 2, 3, 5, 7$ prime, as we expect that it is fulfilled quite often.
This gives the following condition.
\begin{prop}
    Let $f_0, f_1, f_2 \in \Z$ and consider the Elliptic Curve $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$.
    Let $p \in \{3, 5, 7\}$.
    Then there is no $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ if and only if
    \begin{align*}
        p = 3 \ \Rightarrow \ n^3 + f_2 n^2 + f_1 n + f_0 &\equiv 0, 2 \mod 3 \\
        p = 5 \ \Rightarrow \ n^3 + f_2 n^2 + f_1 n + f_0 &\equiv 0, 2, 3 \mod 5 \\
        p = 7 \ \Rightarrow \ n^3 + f_2 n^2 + f_1 n + f_0 &\equiv 0, 3, 5, 6 \mod 7
    \end{align*}
    for all $n \in \Z$.
    
    In particular, this is necessary for $E$ to satisfy the desired properties, i.e. there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ if and only if $p \neq 3, 5, 7$
    \footnote{I understood the task here to be ``if and only if''. As mentioned later, this interpretation is probably wrong, and I will discuss the other case next.}.
\end{prop}
\begin{proof}
    Let $p \in \{3, 5, 7\}$.
    Assume there is some $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z$ with $\tilde{y} \neq 0$.
    Then have
    \begin{equation*}
        y^2 \equiv x^3 + f_2 x^2 + f_1 x + f_0 \mod p
    \end{equation*}
    and so $x^3 + f_2 x^2 + f_1 x + f_0$ is a quadratic residue modulo $p$.
    
    By checking all elements in $\F_3$, $\F_5$ and $\F_7$, one finds
    \begin{align*}
        \text{$n$ quadratic residue modulo $3$} \ &\Leftrightarrow \ n \equiv 0, 1 \mod 3 \\
        \text{$n$ quadratic residue modulo $5$} \ &\Leftrightarrow \ n \equiv 0, 1, 4 \mod 5 \\
        \text{$n$ quadratic residue modulo $7$} \ &\Leftrightarrow \ n \equiv 0, 1, 4, 2 \mod 7
    \end{align*}
    Except for $n \equiv 0 \mod p$, these cases have been excluded by assumption.
    However we assumed that $y \not\equiv 0 \mod p$, so $y^2 \not\equiv 0 \mod p$ and the claim follows.

    The other direction follows by reversing the above computation.
    The claim now follows from Proposition~\ref{prop:p_adic_points_techniques}.
\end{proof}
However, there is one problem here.
Using a computer, one can easily find (e.g. by trying all possibilities) that there are no $f_0, f_1, f_2 \in \Z$ such that the above conditions are (simultaneously) fulfilled for $3$, $5$ and $7$.
This seems to indicate that I have indeed misunderstood the task, and we only look for Elliptic Curves $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ such that there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ for every $p \neq 3, 5, 7$, and do not require further properties for $E(\Z_3), E(\Z_5)$ and $E(\Z_7)$.

So instead consider a strengthening of the last part of Proposition~\ref{prop:p_adic_points_techniques}.
\begin{prop}
    \label{prop:points_in_EZp}
    Let $p \geq 11$ be a prime and $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ an Elliptic Curve with $f_0, f_1, f_2 \in \Z$.
    Then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
\end{prop}
\begin{proof}
    If $p \geq 11$ and $p \notdivides \Delta(E)$ then $\tilde{E}$ is an Elliptic Curve over $\F_p$ and the claim follows from Proposition~\ref{prop:p_adic_points_techniques}.
    
    So assume now that $p \divides \Delta(E)$, hence $x^3 + f_2 x^2 + f_1 x + f_0$ factors as
    \begin{equation*}
        x^3 + \tilde{f}_2 x^2 + \tilde{f}_1 x + \tilde{f}_0 \equiv (x - \alpha)^2(x - \beta)
    \end{equation*}
    with $\alpha, \beta \in \bar{\F}_p$.
    However, note that $\F_p$ is perfect, so $(x - \alpha)^2(x - \beta)$ cannot be irreducible over $\F_p$, otherwise $\F_p[x] / \langle(x - \alpha)^2(x - \beta)\rangle$ would be a non-separable field extension of $\F_p$.
    Thus, either $\alpha \in \F_p$ or $\beta \in \F_p$.
    If $\alpha \in \F_p$, then clearly also $\beta = -2\alpha - \tilde{f}_2 \in \F_p$.
    If $\beta \in \F_p$, then also $(x - \alpha)^2 \in \F_p[x]$ and again by perfectness of $\F_p$, note that $\alpha \in \F_p$.
    So $\alpha, \beta \in \F_p$.

    Now note that for $t \in \F_p$ have
    \begin{equation*}
        \left( t^2 + \beta, \ t (t^2 + \beta - \alpha) \right) \in \tilde{E}
    \end{equation*}
    Hence, we find a function
    \begin{equation*}
        \phi: \F_p \to \tilde{E}(\F_p) \setminus \{\O\}, \quad t \mapsto \left( t^2 + \beta, \ t (t^2 + \beta - \alpha) \right)
    \end{equation*}
    If there is $\gamma \in \F_p$ with $\gamma^2 = \alpha - \beta$, then 
    \begin{equation*}
        \restr{\phi}{\F_p \setminus \{-\gamma\}}: \F_p \setminus \{-\gamma\} \to \tilde{E}(\F_p)
    \end{equation*}
    is injective, otherwise $\phi$ is injective.
    Hence, we see that $\#(\tilde{E}(\F_p) \setminus \{\O\}) \geq \#\F_p - 1 \geq 4$ and so $\#\tilde{E}(\F_p) \geq 5$.
    It follows that there is $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p)$ with $\tilde{y} \neq 0$.
    By a Hensel-lifting argument as in Proposition~\ref{prop:p_adic_points_techniques}, we now see that there is $\gamma \in \Z_p$ with $(x, \gamma) \in E(\Z_p)$ and $|\gamma|_p = 1$.
\end{proof}
The above proposition shows that constructing Elliptic Curves $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ such that there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ for all primes $p \neq 3, 5, 7$ is indeed quite simple, as almost all curves satisfy this.
This only case that can fail is $p = 2$, but here, the condition is fulfilled quite often, so we can just try different choices.
\begin{example}
    Let
    \begin{align*}
        E_1: \ &y^2 = x^3 + 2 x \\
        E_2: \ &y^2 = x^3 + 2 x^2 + 6 x + 5\\
        E_3: \ &y^2 = x^3 + 6x + 1
    \end{align*}
    Note that
    \begin{align*}
        1^2 &\equiv 3^3 + 2 \cdot 3 = 33 \mod 8 \\
        1^2 &\equiv 2^3 + 2 \cdot 2^2 + 6 \cdot 2 + 5 = 33 \mod 8 \\
        1^2 &\equiv 4^3 + 6 \cdot 4 + 1 = 89 \mod 8
    \end{align*}
    so Hensel's Lemma yields points $(x, y) \in E_i(\Z_2)$ with $|y|_2 = 1$ for $i \in \{1, 2, 3\}$.
    By Proposition~\ref{prop:points_in_EZp}, we have points $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ for all $p \geq 11$.

    Finally, note that trying all points shows
    \begin{align*}
        \tilde{E}_1(\F_3) &= \{ (0, 0), (1, 0), (2, 0), \O \} \\
        \tilde{E}_1(\F_5) &= \{ (0, 0), \O \} \\
        \tilde{E}_2(\F_7) &= \{ (1, 0), (5, 0), (6, 0), \O \}
    \end{align*}
    so there is no point $(x, y) \in E_i(\Z_p)$ with $|y|_p = 1$ for $p \in \{3, 5, 7\}$ and a suitable $i$. 
\end{example}

\section{Question 2}
\begin{example}[2(i)]
    Consider the Elliptic Curve $E: y^2 = x(x + 1)(x + 4)$ defined over $\Q$.
    Have
    \begin{equation*}
        x(x + 1)(x + 4) = x^3 + 5x^2 + 4x = \left( x + \frac 5 3 \right)^3 - \frac {13} 3 \left( x + \frac 5 3 \right) + \frac {70} {27}
    \end{equation*}
    So $E$ is isomorphic to $E': y^2 = x^3 - \frac {13} 3 x + \frac {70} {27}$ via
    \begin{equation*}
        \psi: E \to E', \quad (x, y) \mapsto \left( x + \frac 5 3, y \right)
    \end{equation*}
    This isomorphism preserves the group structure\footnote{It is a general result that all isogenies are group homomorphisms, but in this case, it is also directly obvious as the isomorphism is linear, hence maps lines to lines.}, and so $E'_{\mathrm{tors}} \cong E_{\mathrm{tors}}$.
    Have
    \begin{equation*}
        \Delta(E') = 4 \left( -\frac {13} 3 \right)^3 + 27 \left( \frac {70} {27} \right)^2 = -144 = \Delta(E)
    \end{equation*}
    Consider now any prime $p \neq 2, 3$.
    Then the isomorphism $\psi: E \to E'$ induces an isomorphism $\tilde{\psi}: \tilde{E} \to \tilde{E}'$ between the reductions modulo $p$.
    Note that $\tilde{E}, \tilde{E}'$ are still Elliptic Curves.

    Hence, we can use results from the lecture on the reduction modulo $p \neq 2, 3$ for the curve $E$, even though it is not given by an equation of the form $y^2 = x^3 + Ax + B$, as all these statements are preserved under isomorphism.
    In particular, we see that the kernel of reduction $E_1(\Q_5)$ has no torsion and so there is an embedding
    \begin{equation*}
        E_{\mathrm{tors}}(\Q) \hookrightarrow \tilde{E}(\F_5)
    \end{equation*}
    Note that
    \begin{equation*}
        \tilde{E}(\F_5) = \{ (0, 0), (1, 0), (2, 1), (2, 4), (3, 2), (3, 3), (4, 0), \O \}
    \end{equation*}
    has order 8.
    Clearly
    \begin{equation*}
        (0, 0), (-1, 0), (-4, 0), \O \in E_{\mathrm{tors}}(\Q)
    \end{equation*}
    So the only remaining question is whether this is all the torsion (i.e. $\#E_{\mathrm{tors}}(\Q) = 4$) or there are more points (i.e. $\#E_{\mathrm{tors}}(\Q) = 8$).

    Consider now $P = (-2, 2) \in E$.
    The tangent at $P$ is given by $y = -x$ and the third point of intersection with $E$ is thus $(0, 0)$.
    Hence $P + P = (0, 0)$ and so $[4]P = \O$.
    It follows that $\#E_{\mathrm{tors}}(\Q) = 8$ and furthermore that 
    \begin{equation*}
        E_{\mathrm{tors}}(E) = \langle P, (-1, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}
\end{example}
\begin{example}[2(ii)]
    \label{ex:2ii}
    Consider the Elliptic Curve $E: y^2 = x(x + 1)(x - 8)$.
    Note that we have an isomorphism
    \begin{equation*}
        \psi: E \to E', \quad (x, y) \mapsto \left( x - \frac 7 3, y \right)
    \end{equation*}
    to the Elliptic Curve $E': y^2 = x^3 - \frac {73} 3 x - \frac {1190} {27}$ defined over $\Q$.
    Have that
    \begin{equation*}
        \Delta(E) = -72^2 = -5184 = \Delta(E')
    \end{equation*}
    Note that this has only the prime factors $2$ and $3$.
    As before, this shows that all the results from the lecture on the reduction modulo $p \neq 2, 3$ are also valid for the curve $E$, even though it is not defined by an equation of the form $y^2 = x^3 + Ax + B$.
    We see that
    \begin{equation*}
        \tilde{E}(\F_7) = \{ (0, 0), (1, 0), (4, 2), (4, 5), (5, 1), (5, 6), (6, 0), \O \}
    \end{equation*}
    and thus has order 8.
    As before, we this only leaves two possible cases, either the obvious 2-torsion points are all torsion points (i.e. $\#E_{\mathrm{tors}}(\Q) = 4$) or each of the points $\tilde{E}(\F_5)$ lifts to a torsion point (i.e. $\#E_{\mathrm{tors}}(\Q) = 8$).

    Unlike the previous example however, this time the former is the case.
    To see this, we use the Nagell-Lutz theorem.
    Assume $(x, y) \in E_{\mathrm{tors}}(\Q)$ with $y \neq 0$.
    Then it yields that $y^2 \divides \Delta(E) = -72^2$ and so $y \divides 72$.
    So
    \begin{equation*}
        y \in \{ \pm 1, \pm 2, \pm 4, \pm 8, \pm 3 \pm 6, \pm 12, \pm 24, \pm 9, \pm 18, \pm 36, \pm 72 \}
    \end{equation*}
    Furthermore $y \not\equiv 0 \mod 7$ and since $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_7)$, it follows that
    \begin{equation*}
        (\tilde{x}, \tilde{y}) \in \{ (4, \pm 2), (5, \pm 1) \} \ \Rightarrow \ \tilde{y} \in \{ \pm 1, \pm 2 \}
    \end{equation*}
    Thus we only have the possibilities
    \begin{equation*}
        y \in \{ \pm 1, \pm 2, \pm 8, \pm 6, \pm 12, \pm 9, \pm 36, \pm 72 \}
    \end{equation*}
    Furthermore, observe that
    \begin{equation*}
        \tilde{E}(\F_{11}) = \{ (0, 0), (5, 3), (5, 8), (6, 2), (6, 9), (8, 0), (10, 0), \O \}
    \end{equation*}
    and so it follows by the same argument that
    \begin{equation*}
        \tilde{y} \in \{ \pm 2, \pm 3 \}
    \end{equation*}
    This further restricts the possibilities to
    \begin{equation*}
        y \in \{ \pm 2, \pm 8, \pm 12, \pm 9 \}
    \end{equation*}
    Finally, observe that none of the equations
    \begin{align*}
        4 &= x^3 - 7x^2 - 8x \\
        64 &= x^3 - 7x^2 - 8x \\
        144 &= x^3 - 7x^2 - 8x \\
        81 &= x^3 - 7x^2 - 8x
    \end{align*}
    has a solution in $\Q$.
    To see this, use e.g. the rational root theorem and some computation:

    The only factors of $4$ are $\pm 1, \pm 2, \pm 4$ and none solves $4 = x^3 + 7x^2 - 8x$.
    The only factors of $64$ are $\pm 1, \pm 2, \pm 4, \pm 8, \pm 16, \pm 32, \pm 64$ and none solves $64 = x^3 - 7x^2 - 8x$.
    The only factors of $144$ are $\pm 1, \pm 2, \pm 4, \pm 8, \pm 16, \pm 3, \pm 6, \pm 12, \pm 24, \pm 48, \pm 9, \pm 18, \pm 36, \pm 72, \pm 144$ and none solves $144 = x^3 - 7x^2 - 8x$.
    The only factors of $81$ are $\pm 1, \pm 3, \pm 9, \pm 27, \pm 81$ and none solves $81 = x^3 - 7x^2 - 8x$.

    Note that the usual approach to bound the size of $E_{\mathrm{tors}}(\Q)$ is use to the theorem that this embeds into $\tilde{E}(\F_p)$ whenever $\tilde{E}$ is an Elliptic Curve.
    However, for this example, this was not sufficient, as we could not find a prime such that the group $\Z/4\Z \oplus \Z/2\Z$ does not embed into $\tilde{E}(\F_p)$.
    In the next part, we want to study this phenomenon more carefully and indeed see that there is no such prime, i.e. just considering reduction modulo $p$ is not sufficient to compute the torsion group of $E$.
\end{example}
First, it is convenient to have a closed formula for the $x$-coordinate of $[2]P$ for a point $P$ on an Elliptic Curve.
\begin{prop}
    \label{prop:duplication_formula}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve over a field $k$.
    For a point $P \in E$ with $P \neq \O$ denote by $x(P)$ its (affine) $x$-coordinate.
    Then have for all $P \in E$ with $P \neq -P$ that
    \begin{equation*}
        x([2]P) = \frac {x(P)^4 - 2a_4 x(P)^2 - 8a_6x(P) + a_4^2 - 4a_2a_6} {4(x(P)^3 + a_2 x(P)^2 + a_4 x(P) + a_6)}
    \end{equation*}  
\end{prop}
\begin{prop}
    Let $E: y^2 = x(x + 1)(x - 8)$ be the Elliptic Curve from the previous example.
    The for each prime $p \geq 5$, have that $\Z/4\Z \oplus \Z/2\Z$ is a subgroup of $\tilde{E}(\F_p)$.
\end{prop}
\begin{proof}
    First of all, note that the duplication formula from Proposition~\ref{prop:duplication_formula} has the form
    \begin{equation*}
        x([2]P) = \frac {x(P)^4 + 16 x(P) + 64} {4 x(P)^3 - 28 x(P)^2 - 32 x(P)}
    \end{equation*}
    Consider any prime $p \geq 5$.

    \paragraph{Case 1} If $-1$ is a quadratic residue modulo $p$, then there is $\beta \in \F_p$ with $\beta^2 = -36$.
    Have then that $(2, \beta) \in \tilde{E}(\F_p)$ and
    \begin{equation*}
        x([2](2, \beta)) = \frac {2^4 + 16 \cdot 2^2 + 64} {4 \cdot 2^3 - 28 \cdot 2^2 - 32 \cdot 2} = \frac {144} {-144} = -1
    \end{equation*}
    and so $[2](2, \beta) = (-1, 0)$ is a 2-torsion point.
    Thus $(2, \beta)$ has order $4$ and we see that
    \begin{equation*}
        \langle (2, \beta), (0, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    \paragraph{Case 2} If $-2$ is a quadratic residue modulo $p$, then there is $\alpha \in \F_p$ with $\alpha^2 = -8$.
    Then
    \begin{equation*}
        (\alpha - 8)^2 = (\alpha^2 + \alpha)(\alpha - 8) = \alpha(\alpha + 1)(\alpha - 8)
    \end{equation*}
    With $\beta := \alpha - 8$ we now find $(\alpha, \beta) \in \tilde{E}(\F_p)$ and
    \begin{equation*}
        x([2](\alpha, \beta)) = \frac {\alpha^4 + 16 \alpha^2 + 64} {4 \alpha^3 - 28 \alpha^2 - 32 \alpha} = \frac {(\alpha^2 + 8)^2} {4 \alpha^3 - 28 \alpha^2 - 32 \alpha} = 0
    \end{equation*}
    and so $[2](\alpha, \beta) = (0, 0)$ is a 2-torsion point.
    Hence, $(\alpha, \beta)$ has order $4$ and thus
    \begin{equation*}
        \langle (\alpha, \beta), (-1, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    \paragraph{Case 3} If $2$ is a quadratic residue modulo $p$, then there is $\alpha' \in \F_p$ with $(\alpha')^2 = 72$ and so there is $\alpha = \alpha' + 8$ with $\alpha^2 - 16\alpha - 8 = 0$.
    Note that $\alpha^2 = 16\alpha + 8$ and thus
    \begin{equation*}
        (9\alpha - 24)^2 = 81 \cdot 16 \alpha + 81 \cdot 8 - 432 \alpha + 576 = 1224 + 864\alpha = \alpha^3 - 7\alpha^2 - 8\alpha= \alpha (\alpha + 1) (\alpha - 8)
    \end{equation*}
    With $\beta := 9\alpha - 24$ we now find $(\alpha, \beta) \in \tilde{E}(\F_p)$ and
    \begin{align*}
        x([2](\alpha, \beta)) =& \frac {\alpha^4 + 16 \alpha^2 + 64} {4\alpha^3 - 28\alpha^2 - 32\alpha} = \frac {(\alpha^2 + 8)^2} {4\alpha(\alpha + 1)(\alpha - 8)} \\
        =& \frac {16^2(\alpha + 1)^2} {4\alpha(\alpha + 1)(\alpha - 8)} = \frac {64 (\alpha + 1)} {(\alpha^2 - 8\alpha)} = \frac {64 (\alpha + 1)} {16\alpha + 8 - 8\alpha} = 8
    \end{align*}
    and so $[2](\alpha, \beta) = (8, 0)$ is a 2-torsion point.
    Hence $(\alpha, \beta)$ has order $4$ and thus
    \begin{equation*}
        \langle (\alpha, \beta), (0, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    Since the Legendre symbol is multiplicative and $(-2)(-1) = 2$, these cases are exhaustive.
\end{proof}
\end{document}