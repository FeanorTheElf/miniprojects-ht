\documentclass{scrartcl}

\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{xparse}
\usepackage{geometry}
\usepackage{enumerate}
\usepackage{tikz}
\usepackage{thmtools}
\usepackage{hyperref}
\usepackage[style=english]{csquotes}
\usepackage[language=english, backend=biber, style=alphabetic, sorting=nyt]{biblatex}

\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}

\usetikzlibrary{babel, positioning, shapes.geometric, arrows, arrows.meta}
\addbibresource{bibliography.bib}

\title{Miniproject - Elliptic Curves}
\author{Candidate Number: 1059926}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\V}{\mathbb{V}}
\newcommand{\p}{\mathfrak{p}}
\newcommand{\Set}{\mathrm{\textbf{Set}}}
\newcommand{\Aff}{\mathrm{\textbf{Aff}}}
\newcommand{\Sch}{\mathrm{\textbf{Sch}}}
\newcommand{\Ring}{\mathrm{\textbf{Ring}}}
\newcommand{\Ab}{\mathrm{\textbf{Ab}}}
\newcommand{\Top}{\mathrm{Top}}
\newcommand{\Spec}{\mathrm{Spec}}
\newcommand{\Quot}{\mathrm{Quot}}
\newcommand{\im}{\mathrm{im}}
\renewcommand{\O}{\mathcal{O}}
\DeclareMathOperator*{\colim}{colim}
\newcommand{\notdivides}{\ \nmid \ }
\newcommand{\divides}{\ \mid \ }

\newcommand\restr[2]{{
    \left.\kern-\nulldelimiterspace
    #1
    \vphantom{\big|}
    \right|_{#2}
}}

\theoremstyle{definition}

\newtheorem{prop}[subsection]{Proposition}
\newtheorem{theorem}[subsection]{Theorem}
\newtheorem{lemma}[subsection]{Lemma}
\newtheorem{corollary}[subsection]{Corollary}

\newtheorem{problem}[subsection]{Problem}
\newtheorem{alg}[subsection]{Algorithm}
\newtheorem{definition}[subsection]{Definition}
\newtheorem{example}[subsection]{Example}
\newtheorem{remark}[subsection]{Remark}

\begin{document}
\maketitle
\listoftheorems

\section{Question 1}

\begin{example}[1(i)]
    Have
    \begin{equation*}
        |463^2 + 6|_5 = |214375|_5 = |5^4 \cdot 7^3|_5 = 5^{-4} < 5^{-3}
    \end{equation*}
    To find it, note that $|2^2 + 6|_5 < 1$ and use Newton's method.
    Set $x_0 = 2$ and have
    \begin{align*}
        x_1 = x_0 - \frac {x_0^2 + 6} {2x_0} = 2 - \frac {10} {4} = -\frac 1 2  \\
        x_2 = -\frac 1 2 - \frac {1/4 + 6} {-1} = \frac {25} 4 - \frac 1 2 = \frac {23} 4
    \end{align*}
    and indeed, $|(23/4)^2 + 6|_5 = |625/16|_5 = 5^{-4}$.
    Since the valuation $|\cdot|_5$ is non-Archimedean, observe that $|x^2 + 6|_5 < 5^{-3}$ holds for all $x \in \Q$ with $|x - 32/4|_5 = |4x - 32|_5 < 5^{-3}$.
    Hence, we look for $x \in \Z$ such that $5^4 \divides 4x + 23$.
    In other words, find $k \in \Z$ with $4 \divides k 5^4 - 23$, i.e. $k - 3 \equiv 0 \mod 4$.
    We find $k = 3$ and so $x = 463$.
\end{example}
\begin{example}[1(ii)]
    Let
    \begin{equation*}
        \alpha = 5^{-1} + 2 \cdot 5^0 + 5 (1 + 4 \cdot 5) \sum_{n \geq 0} 5^{2n} \in \Q_5
    \end{equation*}
    Note that in $\Q_5$ we have
    \begin{equation*}
        \sum_{n \geq 0} 5^{2n} = \sum_{n \geq 0} 25^n = \frac 1 {1 - 25} = -\frac 1 {24}
    \end{equation*}
    So
    \begin{equation*}
        \alpha = \frac 1 5 + 2 + 5 (21) \frac 1 {24} = \frac {263} {40}
    \end{equation*}
\end{example}
For the next exercises, we will slightly abuse notation and write
\begin{equation*}
    E(R) := \{ (x, y) \in E(\bar{k}) \ | \ x, y \in R \} \cup \{\O\}
\end{equation*}
for an Elliptic Curve $E$ defined over $k$ and any ring $R$ contained in the algebraic closure $\bar{k}$.
Note that this is in general not a group.
However, it gives us a way to nicely phrase the next statements.
\begin{prop}[1(iii)]
    \label{prop:1iii}
    Consider the Elliptic Curve $E: y^2 = x^3 + 2x + 2$ defined over $\Z$.
    Then $E(\Z) = \{ \O \}$ and
    \begin{equation*}
        E(\Z_p) \neq \{ \O \} \ \Leftrightarrow \ p \neq 3
    \end{equation*}
\end{prop}
\begin{proof}
    First show that there exists some $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ for all primes $p \neq 3$.

    If $p \equiv 1, 5 \mod 8$, then $-1$ is a square in $\F_p$, thus there is $\alpha \in \F_p$ with $\alpha^2 = -1$ and so $(-1, \alpha) \in \tilde{E}(\F_p)$.
    If $p \equiv 7 \mod 8$, then (the law of Quadratic Reciprocity, e.g. \cite[Prop. I.8.6]{neukirch}) it follows that $2$ is a square in $\F_p$.
    Thus there is $\alpha \in \F_p$ with $\alpha^2 = 2$ and so $(0, \alpha) \in \tilde{E}(\F_p)$.

    Hence, consider now the case $p \equiv 3 \mod 8$.
    Note that
    \begin{equation*}
        \Delta(E) = 4 \cdot 2^3 + 27 \cdot 2^2 = 140 = 2^2 \cdot 5 \cdot 7
    \end{equation*}
    Hence we see that $p \notdivides \Delta(E)$ and so $\tilde{E}$ is an Elliptic Curve defined over $\F_p$.
    Now the Hasse bound \cite[Thm 1.15]{lecture} shows that
    \begin{equation*}
        \#\tilde{E}(\F_p) \in [p + 1 - 2\sqrt{p}, p + 1 + 2\sqrt{p}]
    \end{equation*}
    Note that for $p > 9$ have $\sqrt{p} < p/3$ and thus
    \begin{equation*}
        p + 1 - 2\sqrt{p} > 4
    \end{equation*}
    Thus $\tilde{E}(\F_p) \geq 5$ and so there must be $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$, as there are at most four points on $\tilde{E}(\F_p)$ that do not satisfy this ($\O$ and possibly $(\alpha_i, 0)$ with $\alpha_i$ a root of $x^3 + 2x + 2$).

    Now consider any prime $p \neq 2, 3$ and $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z, \tilde{y} \neq 0$.
    Let $f(t) := t^2 - x^3 - 2x - 2$.
    Then
    \begin{equation*}
        |f(y)|_p \leq p^{-1} \quad \text{and} \quad |f'(y)|_p = |y|_p = 1
    \end{equation*}
    Thus $|f(y)|_p < |f'(y)|_p^2$ and Hensel's Lemma yields a root $\gamma \in \Z_p$ with $(x, \gamma) \in E(\Z_p)$.

    In the case $p = 2$, note that $f(t) := t^2 - 5^3 - 2 \cdot 5 - 2 = t^2 - 137$ satisfies
    \begin{equation*}
        |f(1)|_2 = |-136|_2 = |-17 \cdot 2^3|_2 = 2^{-3} < \left( 2^{-1} \right)^2 = |2|_2^2 = |f'(1)|_2^2
    \end{equation*}
    and so Hensel's Lemma \cite[Thm 2.14]{lecture} yields a point $(5, \gamma) \in E(\Z_2)$.

    The only remaining case is $p = 3$, and a trying all 9 points in $\F_3^2$ shows that $\tilde{E}(\F_3) = \{\O\}$.
    This clearly shows that $E(\Z_3) = \{ \O \}$ and so $E(\Z) = \{\O\}$.
\end{proof}
Note that the Hasse bound already yields the statement for all but finitely many primes $p$.
So instead of arguing with Quadratic Reciprocity, we could just explicitly compute $\tilde{E}(\F_p)$ for the remaining $p$.
For general Elliptic Curves, exactly this approach is summarized in the next proposition.
\begin{prop}[Existence of points over $\Z_p$]
    \label{prop:p_adic_points_techniques}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve defined over $\Z$.
    Let $p$ be a prime.
    Then
    \begin{itemize}
        \item If $E(\Z_p) \neq \{\O\}$ then $\tilde{E}(\F_p) \neq \{\O\}$.
        \item Suppose $p \neq 2$. There is $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ if and only if there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
        \item Suppose $p \neq 2$. If $\#\tilde{E}(\F_p) \geq 5$ then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
        \item Suppose $p \geq 11$ and $p \notdivides \Delta(E)$. Then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
    \end{itemize}
\end{prop}
\begin{proof}
    The first part is trivial and follows from the fact that any $(x, y) \in E(\Z_p)$ yields $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p)$.

    For the second part, note that by assumption, there is $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p), x, y \in \Z$ with $|y|_p = 1$ and so
    \begin{equation*}
        |y^2 - x^3 - a_2 x^2 - a_4 x - a_6|_p \leq p^{-1} < 1 = 1^2 = |2y|_p
    \end{equation*}
    Hensel's Lemma now \cite[Thm 2.14]{lecture} shows that there is $\gamma \in \Z_p$ such that $\gamma^2 = x^3 + a_2 x^2 + a_4 x + a_6$ and so $(x, \gamma) \in E(\Z_p)$.
    Since $|y|_p = 1$ clearly also $|\gamma|_p = 1$.
    The other direction is obvious and follows directly by taking the reduction modulo $p$.

    For the third part, notice that there are at most three different points $(x, y) \in \tilde{E}(\F_p)$ with $y = 0$, as in this case $x$ is a root of the cubic $t^3 + a_2 t^2 + a_4 t + a_6$.
    Thus, if $\#\tilde{E}(\F_p) \geq 5$, there must be $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$ and so the claim follows by the second part.

    For the fourth part, note that as above, $p > 9$ implies $\sqrt{p} < p/3$ and so the Hasse bound \cite[Thm 1.15]{lecture} yields (since $\tilde{E}$ is an Elliptic Curve by assumption, as $p \notdivides \Delta(E)$)
    \begin{equation*}
        \#\tilde{E}(\F_p) \geq p + 1 - 2\sqrt{p} > 4
    \end{equation*}
    thus $\#\tilde{E}(\F_p) \geq 5$. 
    The claim now follows by the third part.
\end{proof}
This already shows that we do not have to worry to much about the condition $E(\Z_p) \neq \{\O\}$ for $p \neq 2, 3, 5, 7$ prime, as we expect that it is fulfilled quite often.
My next try was to characterize in which cases there is no $(x, y) \in E(\Z_p)$, $|y|_p = 1$.
However it turns out that this never happens simultaneously for $p \in \{ 3, 5, 7 \}$ (which was how I understood the question at first).
On the other hand, I also found the following strengthening of the previous statement that completely finishes the case $p \geq 11$.
\begin{prop}
    \label{prop:points_in_EZp}
    Let $p \geq 11$ be a prime and $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ an Elliptic Curve with $f_0, f_1, f_2 \in \Z$.
    Then there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$.
\end{prop}
\begin{proof}
    If $p \geq 11$ and $p \notdivides \Delta(E)$ then $\tilde{E}$ is an Elliptic Curve over $\F_p$ and the claim follows from Proposition~\ref{prop:p_adic_points_techniques}.
    
    So assume now that $p \divides \Delta(E)$, hence $x^3 + f_2 x^2 + f_1 x + f_0$ factors as
    \begin{equation*}
        x^3 + \tilde{f}_2 x^2 + \tilde{f}_1 x + \tilde{f}_0 \equiv (x - \alpha)^2(x - \beta)
    \end{equation*}
    with $\alpha, \beta \in \bar{\F}_p$.
    However, note that $\F_p$ is perfect, so $(x - \alpha)^2(x - \beta)$ cannot be irreducible over $\F_p$, otherwise $\F_p[x] / \langle(x - \alpha)^2(x - \beta)\rangle$ would be a non-separable field extension of $\F_p$.
    Thus, either $\alpha \in \F_p$ or $\beta \in \F_p$.
    If $\alpha \in \F_p$, then clearly also $\beta = -2\alpha - \tilde{f}_2 \in \F_p$.
    If $\beta \in \F_p$, then also $(x - \alpha)^2 \in \F_p[x]$ and again by perfectness of $\F_p$, note that $\alpha \in \F_p$.
    So $\alpha, \beta \in \F_p$.

    Now note that for $t \in \F_p$ have
    \begin{equation*}
        \left( t^2 + \beta, \ t (t^2 + \beta - \alpha) \right) \in \tilde{E}
    \end{equation*}
    Hence, we find a function
    \begin{equation*}
        \phi: \F_p \to \tilde{E}(\F_p) \setminus \{\O\}, \quad t \mapsto \left( t^2 + \beta, \ t (t^2 + \beta - \alpha) \right)
    \end{equation*}
    If there is $\gamma \in \F_p$ with $\gamma^2 = \alpha - \beta$, then 
    \begin{equation*}
        \restr{\phi}{\F_p \setminus \{-\gamma\}}: \F_p \setminus \{-\gamma\} \to \tilde{E}(\F_p)
    \end{equation*}
    is injective, otherwise $\phi$ is injective.
    Hence, we see that $\#(\tilde{E}(\F_p) \setminus \{\O\}) \geq \#\F_p - 1 \geq 4$ and so $\#\tilde{E}(\F_p) \geq 5$.
    It follows that there is $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_p)$ with $\tilde{y} \neq 0$.
    By a Hensel-lifting argument as in Proposition~\ref{prop:p_adic_points_techniques}, we now see that there is $\gamma \in \Z_p$ with $(x, \gamma) \in E(\Z_p)$ and $|\gamma|_p = 1$.
\end{proof}
The above proposition shows that constructing Elliptic Curves $E: y^2 = x^3 + f_2 x^2 + f_1 x + f_0$ such that there is $(x, y) \in E(\Z_p)$ with $|y|_p = 1$ for all primes $p \neq 3, 5, 7$ is indeed quite simple, as almost all curves satisfy this.
This only case that can fail is $p = 2$, but here, the condition is fulfilled quite often, so we can just try different choices.
If we additionally want no points $(x, y) \in \tilde{E}(\F_p)$ with $y \neq 0$, then we can for example use a little bit of linear algebra.
\begin{example}[1(iv) - first example]
    Assume we want to find a curve $E: y^2 = f(x) := x^3 + A x + B$ such that $\tilde{E}(\F_3)$ contains no point $(x, y)$ with $y \neq 0$.
    Then have
    \begin{equation*}
        f(0) = B \equiv 0, 2  \quad \text{and} \quad f(1) = 1 + A + B \equiv 0, 2
    \end{equation*}
    since $1$ is the only square in $\F_3^*$.
    For example the case $B \equiv 0$ and $1 + A + B \equiv 0$ yields the solution $B = 0$, $A = 2$ which indeed does yield a curve $E$ with $\tilde{E}(\F_3) = \{ \O \}$.
    Indeed, have that
    \begin{equation*}
        \tilde{E}(\F_3) = \{ (0, 0), (1, 0), (2, 0), \O \}
    \end{equation*}
    Furthermore, we see that
    \begin{equation*}
        \tilde{E}(\F_5) = \{ (0, 0), \O \}
    \end{equation*}
    On the other hand, note that
    \begin{align*}
        1^2 &\equiv 3^3 + 2 \cdot 3 = 33 \mod 8 \\
        3^2 &\equiv 4^3 + 2 \cdot 4 = 72 \mod 7
    \end{align*}
    so Hensel's Lemma yields \cite[Thm 1.15]{lecture} points $(x, y) \in E(\Z_2)$ with $|y|_2 = 1$ and $(x', y') \in E(\Z_7)$ with $|y'|_7 = 1$.

    Interestingly, if we want a curve $E$ such that $\tilde{E}(\F_3) = \{ \O \}$, then we require
    \begin{equation*}
        f(0) = B \equiv 2  \quad \text{and} \quad f(1) = 1 + A + B \equiv 2
    \end{equation*}
    and this has the only solution $A \equiv B \equiv 2$, which indeed works out (this is the curve from Proposition~\ref{prop:1iii}).
\end{example}
This also works for $p = 7$, as the next example shows.
\begin{example}[1(iv) - second example]
    Assume we want to find a curve $E: y^2 = f(x) := x^3 + a_2 x^2 + a_4 x + a_6$ such that $\tilde{E}(\F_7)$ contains no point $(x, y)$ with $y \neq 0$.
    By considering a scaling isomorphism of the form
    \begin{equation*}
        E \to E', \quad (x, y) \mapsto (u^2 x, u^3 y)
    \end{equation*}
    we can assume wlog that $a_2 \equiv 0, 1, 2 \mod 7$ (as each element in $\F_7$ is congruent to $0, 1$ or $2$ modulo the squares $\{ x^2 \ | \ x \in \F_7 \}$).
    Furthermore have
    \begin{equation*}
        f(0) = a_6 \equiv 0, 3, 5, 6, \quad f(1) = 1 + a_2 + a_4 + a_6 \equiv 0, 3, 5, 6
    \end{equation*}
    since $1, 4, 2$ are the squares in $\F_7^*$.
    We find 48 possible solutions, and for example $a_2 \equiv 2, a_4 \equiv 6, a_6 \equiv 5$ works.
    Indeed, have that
    \begin{equation*}
        \tilde{E}(\F_7) = \{ (1, 0), (5, 0), (6, 0), \O \}
    \end{equation*}
    Furthermore, note that
    \begin{align*}
        1^2 &\equiv 2^3 + 2 \cdot 2^2 + 6 \cdot 2 + 5 = 33 \mod 8 \\
        1^2 &\equiv 2^3 + 2 \cdot 2^2 + 6 \cdot 2 + 5 = 33 \mod 3 \\
        2^2 &\equiv 1^3 + 2 \cdot 1^2 + 6 \cdot 1 + 5 = 14 \mod 5
    \end{align*}
    so Hensel's Lemma yields \cite[Thm 1.15]{lecture} points $(x, y) \in E(\Z_2)$ with $|y|_2 = 1$ and $(x', y') \in E(\Z_3)$ with $|y'|_3 = 1$ and $(x'', y'') \in E(\Z_5)$ with $|y''|_5 = 1$.
\end{example}
\begin{example}[(iv) - third example]
    The cubic polynomial $f = x^3 + x$ has roots $0$ and $1$ modulo 2.
    Thus the Elliptic Curve $E: y^2 = x^3 + x$ clearly has no points $(x, y) \in E(\Z_2)$ with $|y|_2 = 1$, as all points $(x, y) \in \tilde{E}(\F_2)$ satisfy $y = 0$.
    Furthermore, see that
    \begin{equation*}
        \tilde{E}(\F_5) = \{ (0, 0), (2, 0), (3, 0), \O \}
    \end{equation*}
    and
    \begin{align*}
        1^2 &\equiv 2^3 + 2 = 10 \mod 3 \\
        3^2 &\equiv 1^3 + 1 = 2 \mod 7
    \end{align*}
    so Hensel's Lemma yields \cite[Thm 1.15]{lecture} points $(x, y) \in E(\Z_3)$ with $|y|_3 = 1$ and $(x', y') \in E(\Z_7)$ with $|y'|_7 = 1$.
\end{example}
Note also that those three examples show that the bound $p \geq 11$ in Proposition~\ref{prop:points_in_EZp} is sharp.

\section{Question 2}
\begin{example}[2(i)]
    Consider the Elliptic Curve $E: y^2 = x(x + 1)(x + 4)$ defined over $\Q$.
    Note that the reduction $\tilde{E}$ modulo 5 is still an Elliptic Curve, as the roots $0, 1, 4$ are distinct modulo 5.
    By \cite[Lemma 5.1]{lecture}, there is an embedding
    \begin{equation*}
        E_{\mathrm{tors}}(\Q) \hookrightarrow \tilde{E}(\F_5)
    \end{equation*}
    Note that
    \begin{equation*}
        \tilde{E}(\F_5) = \{ (0, 0), (1, 0), (2, 1), (2, 4), (3, 2), (3, 3), (4, 0), \O \}
    \end{equation*}
    has order 8.
    Clearly
    \begin{equation*}
        (0, 0), (-1, 0), (-4, 0), \O \in E_{\mathrm{tors}}(\Q)
    \end{equation*}
    So the only remaining question is whether this is all the torsion (i.e. $\#E_{\mathrm{tors}}(\Q) = 4$) or there are more points (i.e. $\#E_{\mathrm{tors}}(\Q) = 8$).

    Consider now $P = (-2, 2) \in E$.
    The tangent at $P$ is given by $y = -x$ and the third point of intersection with $E$ is thus $(0, 0)$.
    Hence $P + P = (0, 0)$ and so $[4]P = \O$.
    It follows that $\#E_{\mathrm{tors}}(\Q) = 8$ and furthermore that 
    \begin{equation*}
        E_{\mathrm{tors}}(E) = \langle P, (-1, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}
\end{example}
\begin{example}[2(ii)]
    \label{ex:2ii}
    Consider the Elliptic Curve $E: y^2 = x(x + 1)(x - 8)$.
    Note that we have an isomorphism
    \begin{equation*}
        \psi: E \to E', \quad (x, y) \mapsto \left( x - \frac 7 3, y \right)
    \end{equation*}
    to the Elliptic Curve $E': y^2 = x^3 - \frac {73} 3 x - \frac {1190} {27}$ defined over $\Q$.
    Have that
    \begin{equation*}
        \Delta(E) = -72^2 = -5184 = \Delta(E')
    \end{equation*}
    Note that this has only the prime factors $2$ and $3$.
    As before, this shows that all the results from the lecture on the reduction modulo $p \neq 2, 3$ are also valid for the curve $E$, even though it is not defined by an equation of the form $y^2 = x^3 + Ax + B$.
    We see that
    \begin{equation*}
        \tilde{E}(\F_7) = \{ (0, 0), (1, 0), (4, 2), (4, 5), (5, 1), (5, 6), (6, 0), \O \}
    \end{equation*}
    and thus has order 8.
    As before, we this only leaves two possible cases, either the obvious 2-torsion points are all torsion points (i.e. $\#E_{\mathrm{tors}}(\Q) = 4$) or each of the points $\tilde{E}(\F_5)$ lifts to a torsion point (i.e. $\#E_{\mathrm{tors}}(\Q) = 8$).

    Unlike the previous example however, this time the former is the case.
    To see this, we use the Nagell-Lutz theorem \cite[5.4]{lecture}.
    Assume $(x, y) \in E_{\mathrm{tors}}(\Q)$ with $y \neq 0$.
    Then it yields that $y^2 \divides \Delta(E) = -72^2$ and so $y \divides 72$.
    So
    \begin{equation*}
        y \in \{ \pm 1, \pm 2, \pm 4, \pm 8, \pm 3 \pm 6, \pm 12, \pm 24, \pm 9, \pm 18, \pm 36, \pm 72 \}
    \end{equation*}
    Furthermore $y \not\equiv 0 \mod 7$ and since $(\tilde{x}, \tilde{y}) \in \tilde{E}(\F_7)$, it follows that
    \begin{equation*}
        (\tilde{x}, \tilde{y}) \in \{ (4, \pm 2), (5, \pm 1) \} \ \Rightarrow \ \tilde{y} \in \{ \pm 1, \pm 2 \}
    \end{equation*}
    Thus we only have the possibilities
    \begin{equation*}
        y \in \{ \pm 1, \pm 2, \pm 8, \pm 6, \pm 12, \pm 9, \pm 36, \pm 72 \}
    \end{equation*}
    Furthermore, observe that
    \begin{equation*}
        \tilde{E}(\F_{11}) = \{ (0, 0), (5, 3), (5, 8), (6, 2), (6, 9), (8, 0), (10, 0), \O \}
    \end{equation*}
    and so it follows by the same argument that
    \begin{equation*}
        \tilde{y} \in \{ \pm 2, \pm 3 \}
    \end{equation*}
    This further restricts the possibilities to
    \begin{equation*}
        y \in \{ \pm 2, \pm 8, \pm 12, \pm 9 \}
    \end{equation*}
    Finally, observe that none of the equations
    \begin{align*}
        4 &= x^3 - 7x^2 - 8x \\
        64 &= x^3 - 7x^2 - 8x \\
        144 &= x^3 - 7x^2 - 8x \\
        81 &= x^3 - 7x^2 - 8x
    \end{align*}
    has a solution in $\Q$.
    To see this, use e.g. the rational root theorem and some computation:

    The only factors of $4$ are $\pm 1, \pm 2, \pm 4$ and none solves $4 = x^3 + 7x^2 - 8x$.
    The only factors of $64$ are $\pm 1, \pm 2, \pm 4, \pm 8, \pm 16, \pm 32, \pm 64$ and none solves $64 = x^3 - 7x^2 - 8x$.
    The only factors of $144$ are $\pm 1, \pm 2, \pm 4, \pm 8, \pm 16, \pm 3, \pm 6, \pm 12, \pm 24, \pm 48, \pm 9, \pm 18, \pm 36, \pm 72, \pm 144$ and none solves $144 = x^3 - 7x^2 - 8x$.
    The only factors of $81$ are $\pm 1, \pm 3, \pm 9, \pm 27, \pm 81$ and none solves $81 = x^3 - 7x^2 - 8x$.
\end{example}
Note that the usual approach to bound the size of $E_{\mathrm{tors}}(\Q)$ is to use the theorem that this embeds into $\tilde{E}(\F_p)$ whenever $\tilde{E}$ is an Elliptic Curve.
However, for this example, this was not sufficient, as we could not find a prime such that the group $\Z/4\Z \oplus \Z/2\Z$ does not embed into $\tilde{E}(\F_p)$.
In the next part, we want to study this phenomenon more carefully and indeed see that there is no such prime, i.e. it is impossible to show that $\#E_{\mathrm{tors}}(\Q) \neq 8$ by just considering the reductions modulo $p$.

First, it is convenient to have a closed formula for the $x$-coordinate of $[2]P$ for a point $P$ on an Elliptic Curve.
\begin{prop}[Duplication Formula]
    \label{prop:duplication_formula}
    Let $E: y^2 = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve over a field $k$.
    For a point $P \in E$ with $P \neq \O$ denote by $x(P)$ its (affine) $x$-coordinate.
    Then have for all $P \in E$ with $P \neq -P$ that
    \begin{equation*}
        x([2]P) = \frac {x(P)^4 - 2a_4 x(P)^2 - 8a_6x(P) + a_4^2 - 4a_2a_6} {4(x(P)^3 + a_2 x(P)^2 + a_4 x(P) + a_6)}
    \end{equation*}  
\end{prop}
\begin{proof}
    Consider the tangent at $P = (a, b)$.
    Differentiating the equation of $E$ gives
    \begin{equation*}
        2y\frac {dy} {dx} = 3x^2 + 2a_2x + a_4
    \end{equation*}
    so it has slope
    \begin{equation*}
        \lambda = \frac {3a^2 + 2a_2a + a_4} {2b}
    \end{equation*}
    and the equation $y = \lambda (x - a) + b$.
    Note that after plugging this into the equation for $E$, the quadratic term has the coefficient $a_2 - \lambda^2$, so
    \begin{align*}
        x([2]P) &= \lambda^2 - a_2 - 2 x(P) = \frac {(3x(P)^2 + 2a_2x(P) + a_4)^2} {4b^2} - a_2 - 2 x(P) \\
        &= \frac {(3x(P)^2 + 2a_2x(P) + a_4)^2} {4(x(P)^3 + a_2 x(P)^2 + a_4 x(P) + a_6)} - a_2 - 2 x(P)
    \end{align*}
    Expanding this yields the claimed expression.
\end{proof}
Here now comes the promised statement.
\begin{prop}[Reductions mod $p$ are not enough]
    \label{prop:subgroup_mod_every_p}
    Let $E: y^2 = x(x + 1)(x - 8)$ be the Elliptic Curve from the previous example.
    The for each prime $p \geq 5$, have that $\Z/4\Z \oplus \Z/2\Z$ is a subgroup of $\tilde{E}(\F_p)$.
\end{prop}
\begin{proof}
    First of all, note that the duplication formula from Proposition~\ref{prop:duplication_formula} has the form
    \begin{equation*}
        x([2]P) = \frac {x(P)^4 + 16 x(P) + 64} {4 x(P)^3 - 28 x(P)^2 - 32 x(P)}
    \end{equation*}
    Consider any prime $p \geq 5$.

    \paragraph{Case 1} If $-1$ is a quadratic residue modulo $p$, then there is $\beta \in \F_p$ with $\beta^2 = -36$.
    Have then that $(2, \beta) \in \tilde{E}(\F_p)$ and
    \begin{equation*}
        x([2](2, \beta)) = \frac {2^4 + 16 \cdot 2^2 + 64} {4 \cdot 2^3 - 28 \cdot 2^2 - 32 \cdot 2} = \frac {144} {-144} = -1
    \end{equation*}
    and so $[2](2, \beta) = (-1, 0)$ is a 2-torsion point.
    Thus $(2, \beta)$ has order $4$ and we see that
    \begin{equation*}
        \langle (2, \beta), (0, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    \paragraph{Case 2} If $-2$ is a quadratic residue modulo $p$, then there is $\alpha \in \F_p$ with $\alpha^2 = -8$.
    Then
    \begin{equation*}
        (\alpha - 8)^2 = (\alpha^2 + \alpha)(\alpha - 8) = \alpha(\alpha + 1)(\alpha - 8)
    \end{equation*}
    With $\beta := \alpha - 8$ we now find $(\alpha, \beta) \in \tilde{E}(\F_p)$ and
    \begin{equation*}
        x([2](\alpha, \beta)) = \frac {\alpha^4 + 16 \alpha^2 + 64} {4 \alpha^3 - 28 \alpha^2 - 32 \alpha} = \frac {(\alpha^2 + 8)^2} {4 \alpha^3 - 28 \alpha^2 - 32 \alpha} = 0
    \end{equation*}
    and so $[2](\alpha, \beta) = (0, 0)$ is a 2-torsion point.
    Hence, $(\alpha, \beta)$ has order $4$ and thus
    \begin{equation*}
        \langle (\alpha, \beta), (-1, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    \paragraph{Case 3} If $2$ is a quadratic residue modulo $p$, then there is $\alpha' \in \F_p$ with $(\alpha')^2 = 72$ and so there is $\alpha = \alpha' + 8$ with $\alpha^2 - 16\alpha - 8 = 0$.
    Note that $\alpha^2 = 16\alpha + 8$ and thus
    \begin{equation*}
        (9\alpha - 24)^2 = 81 \cdot 16 \alpha + 81 \cdot 8 - 432 \alpha + 576 = 1224 + 864\alpha = \alpha^3 - 7\alpha^2 - 8\alpha= \alpha (\alpha + 1) (\alpha - 8)
    \end{equation*}
    With $\beta := 9\alpha - 24$ we now find $(\alpha, \beta) \in \tilde{E}(\F_p)$ and
    \begin{align*}
        x([2](\alpha, \beta)) =& \frac {\alpha^4 + 16 \alpha^2 + 64} {4\alpha^3 - 28\alpha^2 - 32\alpha} = \frac {(\alpha^2 + 8)^2} {4\alpha(\alpha + 1)(\alpha - 8)} \\
        =& \frac {16^2(\alpha + 1)^2} {4\alpha(\alpha + 1)(\alpha - 8)} = \frac {64 (\alpha + 1)} {(\alpha^2 - 8\alpha)} = \frac {64 (\alpha + 1)} {16\alpha + 8 - 8\alpha} = 8
    \end{align*}
    and so $[2](\alpha, \beta) = (8, 0)$ is a 2-torsion point.
    Hence $(\alpha, \beta)$ has order $4$ and thus
    \begin{equation*}
        \langle (\alpha, \beta), (0, 0) \rangle \cong \Z/4\Z \oplus \Z/2\Z
    \end{equation*}

    Since the Legendre symbol is multiplicative and $(-2)(-1) = 2$, these cases are exhaustive.
\end{proof}
To find more examples, it might be a good idea to use the structure from the previous theorem, but take another set of exhaustive cases.
So consider an Elliptic Curve
\begin{equation*}
    E: y^2 = x(x - \alpha)(x - \beta) = x^3 - (\alpha + \beta)x^2 + \alpha \beta x
\end{equation*}
with 3 nontrivial torsion points $(\alpha, 0), (\beta, 0), (0, 0)$ over $\Q$.
We study in which cases there is some $P \in \tilde{E}(\F_p)$ of order 4.
\begin{lemma}
    \label{prop:condition_z4_subgroup_mod_p}
    Let $E: y^2 = x(x - \alpha)(x - \beta)$ be an Elliptic Curve over a field $k$ of characteristic $\neq 2$.
    Then there exists $P \in E(k)$ of order 4 if and only if at least one of the following is true
    \begin{itemize}
        \item there is $\gamma \in k$ with $\gamma^2 = \alpha\beta$ and $2\gamma - \alpha - \beta$ is square in $k$
        \item there is $\gamma \in k$ with $\gamma^2 = \alpha(\alpha - \beta)$ and $2\gamma + 2\alpha - \beta$ is square in $k$
        \item there is $\gamma \in k$ with $\gamma^2 = \beta(\beta - \alpha)$ and $2\gamma + 2\beta - \alpha$ is square in $k$
    \end{itemize}
\end{lemma}
\begin{proof}
    The duplication formula for $E$ gives with $x = x(P)$ that
    \begin{equation*}
        x([2]P) = d(x) := \frac {x^4 - 2 \alpha \beta x^2 + \alpha^2 \beta^2} {4x^3 - 4(\alpha + \beta) x^2 + 4 \alpha \beta x}
    \end{equation*}

    \paragraph{Case 1} By assumption, there is $\gamma, \mu \in k$ with $\gamma^2 = \alpha\beta$ and $\mu^2 = 2\gamma + \alpha + \beta$.
    Thus
    \begin{equation*}
        d(\gamma) = \frac {\gamma^4 - 2\alpha\beta\gamma^2 + \alpha^2\beta^2} {4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma} = \frac 0 {4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma} = 0
    \end{equation*}
    Note further that
    \begin{equation*}
        \gamma^3 - (\alpha + \beta)\gamma^2 + \alpha\beta\gamma = 2\alpha\beta\gamma - \alpha\beta(\alpha + \beta) = \alpha\beta(2\gamma - \alpha - \beta) = \gamma^2 \mu^2
    \end{equation*}
    So there is a point $(\gamma, \gamma\mu) \in E(k)$ with $[2](\gamma, \mu) = (0, 0)$.

    \paragraph{Case 2} By assumption, there is $\gamma_0, \mu \in k$ with $\gamma_0^2 = \alpha(\alpha - \beta)$ and $\mu^2 = 2\gamma_0 + 2\alpha - \beta$.
    Let $\gamma := \alpha + \gamma_0$.
    Then note that $\gamma^2 - 2\alpha\gamma + \alpha\beta = 0$.
    Thus
    \begin{align*}
        &\gamma^4 - 2 \alpha \beta \gamma^2 + \alpha^2 \beta^2 = 4\alpha \gamma^3 - 4\alpha(\alpha + \beta) \gamma^2 + 4 \alpha^2 \beta \gamma \\
        =& \gamma^4 - 4\alpha \gamma^3 + (4\alpha^2 + 4\alpha\beta - 2\alpha\beta)\gamma^2 - 4\alpha^2\beta \gamma + \alpha^2\beta^2 \\
        =& \gamma^4 - 4\alpha \gamma^3 + 2\alpha(2\alpha + \beta)\gamma^2 - 4\alpha^2\beta \gamma + \alpha^2\beta^2 \\
        =& (\gamma^2 - 2\alpha \gamma + \alpha \beta)^2 = 0^2 = 0
    \end{align*}
    and so
    \begin{equation*}
        \gamma^4 - 2 \alpha \beta \gamma^2 + \alpha^2 \beta^2 = \alpha(4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma)
    \end{equation*}
    It follows that
    \begin{equation*}
        d(\gamma) = \frac {\gamma^4 - 2 \alpha \beta \gamma^2 + \alpha^2 \beta^2} {4\gamma^3 - 4(\alpha + \beta) \gamma^2 + 4 \alpha \beta \gamma} = \alpha
    \end{equation*}
    Furthermore note that
    \begin{align*}
        \gamma^3 - (\alpha + \beta)\gamma^2 + \alpha\beta\gamma =& \gamma(2\alpha\gamma - \alpha\beta) - (2\alpha\gamma - \alpha\beta)(\alpha + \beta) + \alpha\beta\gamma \\
        =& 2\alpha(2\alpha\gamma - \alpha\beta) - 2\alpha^2\gamma - 2\alpha\beta\gamma + \alpha^2\beta + \alpha\beta^2 \\
        =& \gamma(4\alpha^2 - 2\alpha^2 - 2\alpha\beta) + \alpha^2\beta + \alpha\beta^2 - 2\alpha^2\beta \\
        =& 2\alpha\gamma(\alpha - \beta) + \alpha\beta(\beta - \alpha) \\
        =& \alpha(\alpha - \beta)(2\gamma - \beta) \\
        =& (\gamma - \alpha)^2\mu^2
    \end{align*}
    So there is a point $(\gamma, (\gamma - \alpha)\mu) \in E(k)$ with $[2](\gamma, (\gamma - \alpha)\mu) = (\alpha, 0)$.

    \paragraph{Case 3} Exactly as in the previous case, by swapping $\alpha$ and $\beta$.

    The direction $\Leftarrow$ follows by distinguishing the cases $[2]P = (0, 0)$, $[2]P = (\alpha, 0)$ and $[2]P = (\beta, 0)$ and then reversing the above computation.
\end{proof}
As it turns out, we can phrase each of those nested square condition by a condition that two fixed values are squares, which is much nicer to work with.
\begin{lemma}
    \label{prop:condition_double_square}
    Let $k$ be a field of characteristic $\neq 2$ and $\alpha, \beta \in k$.
    \begin{itemize}
        \item there is $\gamma \in k$ with $\gamma = \alpha\beta$ and $2\gamma - \alpha - \beta$ square in $k$ if $-\alpha$ and $-\beta$ are squares in $k$.
        \item there is $\gamma \in k$ with $\gamma = \alpha(\alpha - \beta)$ and $2\gamma + 2\alpha - \beta$ square in $k$ if $\alpha$ and $\alpha - \beta$ are squares in $k$.
        \item there is $\gamma \in k$ with $\gamma = \beta(\beta - \alpha)$ and $2\gamma + 2\beta - \alpha$ square in $k$ if $\beta$ and $\beta - \alpha$ are squares in $k$.
    \end{itemize}
\end{lemma}
\begin{proof}
    Consider $\mu, \rho \in k$ with $\mu^2 = -\alpha$ and $\rho^2 = -\beta$.
    Then $\gamma := \mu\rho$ satisfies $\gamma^2 = \alpha\beta$ and
    \begin{equation*}
        (\mu + \rho)^2 = \mu^2 + 2\mu\rho + \rho^2 = 2\gamma -\alpha - \beta
    \end{equation*}
    Consider now $\mu, \rho \in k$ with $\mu^2 = \alpha$ and $\rho^2 = \alpha - \beta$.
    Then $\gamma := \mu\rho$ satisfies $\gamma^2 = \alpha(\alpha - \beta)$ and
    \begin{equation*}
        (\mu + \rho)^2 = \mu^2 + 2\mu\rho + \rho^2 = 2\gamma + 2\alpha - \beta
    \end{equation*}
    The third claim follows in the same way, by swapping $\alpha$ and $\beta$.
\end{proof}
Combining these two lemmas, it is quite easy to generate more examples.
\begin{example}
    Let $p$ be a prime.
    Taking the set of ``exhaustive cases'' given by $p(-1) = -p$ similar to the proof of Proposition~\ref{prop:subgroup_mod_every_p}.
    In other words, take $\alpha, \beta \in \Z$ such that $-\alpha, -p\beta$ and $\beta - \alpha$ are squares (in $\Z$).
    Then we find for any prime $q$
    \begin{itemize}
        \item If $p$ is a quadratic residue mod $q$, then $-\alpha$ and $-\beta$ are
        \item If $-1$ is a quadratic residue mod $q$, then $\alpha$ and $\alpha - \beta$ are
        \item If $-p$ is a quadratic residue mod $q$, then $\beta$ and $\beta - \alpha$ are
    \end{itemize}
    Hence, by Lemma~\ref{prop:condition_z4_subgroup_mod_p} and Lemma~\ref{prop:condition_double_square}, we see that every reduction $\tilde{E}(\F_q)$ of the Elliptic Curve $E: y^2 = x(x - \alpha)(x - \beta)$ (where $q$ is a prime of good reduction) contains a point of order 4.
    Thus $\Z/4\Z \times \Z/2\Z \hookrightarrow \tilde{E}(\F_q)$.
\end{example}
\begin{example}[2(ii) - Additional Examples]
    Consider the Elliptic Curve $E: y^2 = x(x + 4)(x + 3)$.
    Then $-(-4)$, $(-3)(-3)$ and $-3 - (-4) = 1$ are square, thus $\Z/4\Z \times \Z/2\Z \hookrightarrow \tilde{E}(\F_p)$ for every prime $p$ of good reduction.
    Furthermore, $E(\Q)$ does not have a point of order $4$ by Lemma~\ref{prop:condition_z4_subgroup_mod_p}, since $(-3)(-4) = 12$ and $(-3)(-3 - (-4)) = 3$ are no squares and also $2\gamma + 2(-4) - (-3) = -5 \pm 2 \cdot 2$ is not a square, where $\gamma^2 = (-4)(-4 - (-3)) = 4$.
\end{example}

\section{Question 3}
First, we first look at some basic transformations we can do to Weierstraß equations.
This will be our main toolkit for this exercise.
\begin{prop}[Weierstraß transformations]
    \label{prop:weierstrass_transformations}
    Let $E: y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2 + a_4 x + a_6$ be an Elliptic Curve defined over $k$.
    There are three nice types of transformations
    \begin{description}
        \item[Translation] Let $P = (s, t) \in E(k)$ be a point. Then the isomorphism
        \begin{equation*}
            E \to E', \quad (x, y) \mapsto (x - s, y - t)
        \end{equation*}
        maps $P$ to $(0, 0)$ and the curve $E$ to an Elliptic Curve
        \begin{equation*}
            E': y^2 + a_1 x y + (a_3 + 2t + a_1 s) y = x^3 + (a_2 + 3 s) x^2 + (a_4 - 3 s^2 + 2 a_2 s - a_1 t) x
        \end{equation*}
        This is very useful to clear $a_6$ and continue working with the point $(0, 0)$.
        \item[Shearing] Let $r \in k$. Then the isomorphism
        \begin{equation*}
            E \to E', \quad (x, y) \mapsto (x, y - r x)
        \end{equation*}
        preserves $(0, 0)$ and maps $E$ to an Elliptic Curve
        \begin{equation*}
            E': y^2 + (a_1 + 2r) x y + a_3 y = x^3 + (a_2 + r^2 - a_1 r) x^2 + (a_4 - r a_3) x + a_6
        \end{equation*}
        This is very useful, as it does not change $a_3$ and $a_6$.
        \item[Scaling] Let $u \in k^*$. Then the isomorphism
        \begin{equation*}
            E \to E', \quad (x, y) \mapsto (u^2 x, y^3 y)
        \end{equation*}
        preserves $(0, 0)$ and maps $E$ to an Elliptic Curve
        \begin{equation*}
            E': y^2 + \frac {a_1} u x y + \frac {a_3} {u^3} = x^3 + \frac {a_2} {u^2} x^2 + \frac {a_4} {u^4} x + \frac {a_6} {u^6}
        \end{equation*}
        This is very useful, as it does not change which of the $a_1, ..., a_4, a_6$ are zero.
    \end{description}
\end{prop}
\begin{proof}
    Just plug the equation of the isomorphism into the equation defining the $E'$, and check that it is zero modulo the equation of $E$.
\end{proof}
The next corollary will give us a ``base form'' for equations of Elliptic Curves with special torsion points. 
\begin{corollary}
    \label{prop:point_normalization}
    Let $E$ be an Elliptic Curve defined over $k$ with a $k$-rational point $P$ that is not a 2-torsion point.
    Then there is an Elliptic Curve $E'$ and a linear isomorphism $\psi: E \to E'$ such that $P \mapsto (0, 0)$ and the tangent at $(0, 0)$ on $E'$ is given by the equation $y = 0$.
    
    Furthermore $E'$ is given by an equation of the form
    \begin{equation*}
        E': y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2
    \end{equation*}
    and $[2](0, 0) = (-a_2, a_1 a_2 - a_3)$.
\end{corollary}
\begin{proof}
    After a translation by $-P$, we may assume that
    \begin{equation*}
        E: y^2 + a'_1 x y + a'_3 y = x^3 + a'_2 x^2 + a'_4 x
    \end{equation*}
    and $P = (0, 0)$.
    Now observe that if $a'_3 = 0$, the line $x = 0$ through $(0, 0)$ and $\O$ meets $E$ in $(0, 0)$ with multiplicity 2, and so $(0, 0) + \O = (0, 0)$, contradicting the assumption that $P$ is not a 2-torsion point.
    Thus $a'_3 \neq 0$ and a shearing with $r = a'_4 / a'_3$ maps $E$ to
    \begin{equation*}
        E': y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2
    \end{equation*}
    Note that the tangent at $(0, 0)$ now has slope $0$, i.e. is given by $y = 0$.
    Furthermore, the third point of intersection of the tangent and $E$ is $(-a_2, 0)$.
    The line through $\O$ and $(-a_2)$ is given by $x = -a_2$ and its third point of intersection with $E$ is then $(-a_2, a_1a_2 - a_3)$. 
\end{proof}
I came up with the next lemma to make my first proof of 3(i) work.
Since then, I have found a simpler proof that does not require the lemma anymore, but I found it beautiful and did not want to delete it.
\begin{lemma}
    \label{prop:share_subgroup_equal}
    Let $E, E'$ be Elliptic Curves defined over any field $k$, and assume they share a cyclic subgroup of order $n \geq 5$\footnote{Technically, we can also allow infinite order here.}.
    With this, we mean there is a point $P \in E \cap E'$ of order $n$ such that
    \begin{equation*}
        G := \langle P \rangle_E \subseteq E' \quad \text{and} \quad \restr{+_E}{G \times G} = \restr{+_{E'}}{G \times G}
    \end{equation*}
    Then $E = E'$ (in the sense that they have the same defining equation).
\end{lemma}
\begin{proof}
    Consider some point $[i] P = (a, b) \in E \cap E'$.
    With $P' = (a', b') := -[2i] P \in E \cap E'$ we see that $P + P + P' = \O$ and so $P, P, P'$ are colinear\footnote{We mean that the line through $P$ and $P'$ meets $E$ resp. $E'$ at $P$ with multiplicity 2.}.
    In particular, the tangent on $E$ resp. on $E'$ at $P \in E \cap E'$ both have the slope $(b - b')/(a - a')$\footnote{Or infinity if $a = a'$, but importantly, the slopes are equal.}.

    Since $P$ has order at least 5, observe that $P, [2]P, [3]P, [4]P$ and $[5]P$ are all different.
    Furthermore, since $E$ and $E'$ have the same tangent slope at each $[i] P$, note that $E$ meets $E'$ in $[i] P$ with multiplicity 2.
    So $E$ meets $E'$ in at least 10 points (counting multiplicity), which is greater than the product of their degrees $9 = 3 \cdot 3$.
    By Bezout's theorem \cite[Corollary I.7.8]{hartshorne}, it follows that $E$ and $E'$ share an irreducible component of dimension $\geq 1$, but since both are Elliptic Curves, they are irreducible of dimension $1$ and so $E = E'$.
\end{proof}
Finally we can proof the statement on 5-torsion points.
\begin{prop}[3(i)]
    Let $E$ be an Elliptic Curve defined over $\Q$.
    Then $E(\Q)$ has a nontrivial 5-torsion point if and only if $E$ is isomorphic (over $\Q$) to an Elliptic Curve given by an equation of the form
    \begin{equation*}
        y^2 + (v + 1)x y + v y = x^3 + v x^2
    \end{equation*}
\end{prop}
\begin{proof}
    By Corollary~\ref{prop:point_normalization}, we can assume that $E$ is given as
    \begin{equation*}
        E: y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2
    \end{equation*}
    and $(0, 0)$ is a 5-torsion point of $E$ such that the tangent at $(0, 0)$ on $E$ is given by $y = 0$.
    Further, have $[2](0, 0) = (-a_2, a_1 a_2 - a_3)$.
    After applying a scaling, assume further that $a_2 = a_3$.
    Now define $\beta = a_2(a_1 - 1)$.
    Thus $[2](0, 0) = (-a_2, \beta)$.
    By computing the third point of intersection between $E$ and the lines $x = 0$ resp. $x = -a_2$ we see that 
    \begin{equation*}
        [3](0, 0) = -[2](0, 0) = (-a_2, 0), \quad [4](0, 0) = (0, -a_3)
    \end{equation*}
    Now consider the tangent at $[2](0, 0) = (-a_2, \beta)$.
    It has slope
    \begin{align*}
        \lambda =& \frac {3 a_2^2 - 2 a_2^2 - a_1 \beta} {2\beta - a_1 a_2 + a_3} = \frac {a_2^2 - a_1\beta} \beta = \frac {a_2^2 - a_1a_2(a_1 - 1)} \beta = \frac {(a_2 - a_1(a_1 - 1))a_2} {a_2(a_1 - 1)} \\
        =& \frac {a_2 - a_1(a_1 - 1)} {a_1 - 1} = \frac {a_2} {a_1 - 1} - a_1
    \end{align*}
    Since $[4](-a_2, \beta) = [4](0, 0) = -(0, 0)$, observe that $(0, 0)$ must be a point on the tangent $y = \lambda (x + a_2) + \beta$.
    Thus $\lambda a_2 + \beta = 0$ and so
    \begin{equation*}
        \frac {a_2^2} {a_1 - 1} - a_1 a_2 + a_2(a_1 - 1) = 0
    \end{equation*}
    Clearly $a_2 \neq 0$ and thus
    \begin{equation*}
        0 = a_2 - a_1 (a_1 - 1) + (a_1 - 1)^2 = a_2 - a_1 - 1
    \end{equation*}
    So $a_1 = a_2 + 1$ and the claim follows with $v = a_2 = a_3$.
\end{proof}
More or less the same approach works for other $n \neq 5$.
However, the case of 2-torsion points is special (but nevertheless quite easy).
The following is IMO the nicest form for curves with a nontrivial 2-torsion point, even though there are still 2 parameters (and not just one).
\begin{prop}[3(ii) - $2$-torsion points]
    Let $E$ be an Elliptic Curve defined over $\Q$.
    Then $E(\Q)$ has a nontrivial 2-torsion point if and only if $E$ is isomorphic (over $\Q$) to an Elliptic Curve given by an equation of the form
    \begin{equation*}
        y^2 = x^3 + a_2 x^2 + a_4 x
    \end{equation*}
\end{prop}
\begin{proof}
    Assume $E: y^2 = x^3 + a_2 x^2 + a_4 x$ is an Elliptic Curve.
    Then clearly $(0, 0) \in E(\Q)$ and $(0, 0) = -(0, 0)$, so $(0, 0)$ is nontrivial 2-torsion point.
    Hence, there is a nontrivial 2-torsion point in $E'(\Q)$ for all Elliptic Curves $E'$ that are isomorphic (over $\Q$) to $E$.

    Conversely, let $E$ be an Elliptic Curve with a nontrivial 2-torsion point in $E(\Q)$.
    Note that $E$ is isomorphic to an Elliptic Curve 
    \begin{equation*}
        E': y^2 = x^3 + a_2 x^2 + a_4 x + a_6
    \end{equation*}
    as this holds for every Elliptic Curve.
    Now let $(\alpha, \beta) \in E'(\Q)$ be a nontrivial 2-torsion point.
    Thus $-(\alpha, \beta) = (\alpha, \beta)$, so $\beta = 0$ and $\alpha^3 + a_2 \alpha^2 + a_4 \alpha + a_6 = 0$.
    Now consider the isomorphism
    \begin{equation*}
        E' \to E'', \quad (x, y) \mapsto (x - \alpha, y)
    \end{equation*}
    where
    \begin{equation*}
        E'': y^2 = x^3 + (3\alpha + a_2) x^2 + (3\alpha^2 + 2\alpha a_2 + a_4)x + \underbrace{\alpha^3 + \alpha^2a_2 + \alpha a_4 + a_6}_{= 0}
    \end{equation*}
    Observe that $E''$ is of the described form, and the claim follows. 
\end{proof}
The case $N = 3$ is slightly more interesting.
Our approach is as follows:
\begin{itemize}
    \item Apply a translation to get an isomorphic curve whose (nontrivial) 3-torsion point is $(0, 0)$ and the tangent is given by $y = 0$.
    \item Observe that $(0, 0)$ being a 3-torsion point is equivalent to the fact that the tangent at $E$ through $(0, 0)$ meets $E$ at $(0, 0)$ with multiplicity three.
    \item Show that after a scaling, the resulting equation is nice.
\end{itemize}
Now we get
\begin{prop}[3(ii) - 3-torsion points]
    Let $E$ be an Elliptic Curve defined over $\Q$.
    Then $E(\Q)$ has a nontrivial 3-torsion point if and only if $E$ is isomorphic (over $\Q$) to an Elliptic Curve given by an equation of the form
    \begin{equation*}
        y^2 + x y + v y = x^3
    \end{equation*}
\end{prop}
\begin{proof}
    By Corollary~\ref{prop:point_normalization} we can assume wlog that
    \begin{equation*}
        E: y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2
    \end{equation*}
    and $(0, 0) \in E(\Q)$ is a nontrivial 3-torsion point.

    Now note that the tangent at $(0, 0)$ has slope $m = 0/a_3 = 0$.
    Hence, since $-[2](0, 0) = (0, 0)$ is the third point of intersection of $E$ and the tangent, we see that the tangent meets $E$ at $(0, 0)$ with multiplicity three.
    Thus
    \begin{equation*}
        x^3 + a_2 x^2 
    \end{equation*}
    must already be $x^3$ and thus have $a_2 = 0$.
    Finally, apply a scaling with $u = a_1$ (note that $a_1 \neq 0$, otherwise the curve would be singular) and find that $E$ is isomorphic to the curve
    \begin{equation*}
        E': y^2 + x y + v y = x^3
    \end{equation*}
    where $v = a_3 / (a_1)^3$.

    Conversely, assume that $E$ is isomorphic to an Elliptic Curve of the above form, so wlog
    \begin{equation*}
        E: y^2 + x y + v y = x^3
    \end{equation*}
    We show that $(0, 0) \in E(\Q)$ has order 3.
    The tangent at $(0, 0)$ has slope $0$, so is given by the line $y = 0$.
    Plugging this in yields $x^3 = 0$, and so the third point of intersection with $E$ is $(0, 0)$.
    
    Now consider the line through $\O$ and $(0, 0)$, which is given by $x = 0$.
    Plugging this in yields $y^2 + v y = 0$ and so the third point of intersection is $(0, -v)$.
    Now note that $(0, 0)$, $(0, -v)$ and $\O$ are colinear, so $(0, 0) + (0, -v) + \O = \O$, hence $(0, 0) = -[2](0, 0)$ has order 3.
\end{proof}
A similar approach works also for 4-torsion points.
\begin{prop}[3(ii) - 4-torsion points]
    Let $E$ be an Elliptic Curve defined over $\Q$.
    Then $E(\Q)$ has a nontrivial 4-torsion point if and only if $E$ is isomorphic (over $\Q$) to an Elliptic Curve given by an equation of the form
    \begin{equation*}
        y^2 + x y + v y = x^3 + v x^2
    \end{equation*}
\end{prop}
\begin{proof}
    Again, by Corollary~\ref{prop:point_normalization}, assume wlog that
    \begin{equation*}
        E: y^2 + a_1 x y + a_3 y = x^3 + a_2 x^2
    \end{equation*}
    and $(0, 0) \in E(\Q)$ is a nontrivial 4-torsion point.
    Find that $[2](0, 0) = (-a_2, \beta)$ where $\beta = a_1 a_2 - a_3$.
    The tangent at $(-a_2, \beta)$ must have the equation $x = -a_2$ since $(-a_2, \beta)$ is 2-torsion by assumption.
    Thus
    \begin{equation*}
        0 = 2\beta - a_1a_2 + a_3 = \beta
    \end{equation*}
    and so $a_1a_2 = a_3$.
    By scaling with $a_1$ (which is nonzero, otherwise $a_3 = 0$ and the curve is singular), observe that $E$ is isomorphic to the curve
    \begin{equation*}
        E': y^2 + x y + v y = x^3 + v x^2
    \end{equation*}
    where $v = a_3 / a_1^3 = a_2 / a_1^2$.

    Conversely, assume that $E$ is isomorphic to an Elliptic Curve of the above form, so wlog
    \begin{equation*}
        E: y^2 + x y + v y = x^3 + v x^2
    \end{equation*}
    We show that $(0, 0) \in E(\Q)$ has order $4$.
    The tangent has slope $0$, so is given by the line $y = 0$.
    The third point of intersection with $E$ is now $(-v, 0)$.
    Note that the line through $(-v, 0)$ and $\O$ has the equation $x = -v$ and meets $E$ at $(-v, 0)$ with multiplicity 2.
    It follows that $(-v, 0)$ is a 2-torsion point, and so $E(\Q)$ has the point $(0, 0)$ of order 4.
\end{proof}
It looks like we could continue in a similar way for e.g. 6-or 7-torsion points, but the algebra becomes more and more convoluted. 
\begin{example}[3(ii) - first example]
    Consider the Elliptic Curve
    \begin{equation*}
        E: y^2 + x y + y = x^3
    \end{equation*}
    defined over $\Q$.
    Note that the reduction $\tilde{E}$ modulo $3$ is still an Elliptic Curve (If $3x^2 - y = 2y + 1 + x \equiv 0$ then $y \equiv 0$ and $x \equiv -1$, but $(-1, 0) \notin \tilde{E}(\F_3)$).
    Trying all values in $\F_3^2$, we find
    \begin{equation*}
        \tilde{E}(\F_3) = \{ (0, 0), (0, 2), \O \} 
    \end{equation*}
    Clearly $E(\Q)$ has the 3-torsion point $(0, 0)$, and since $E_{\mathrm{tors}}(\Q) \hookrightarrow \tilde{E}(\F_3)$ we see that
    \begin{equation*}
        E_{\mathrm{tors}}(\Q) = \{ (0, 0), (0, -1), \O \}
    \end{equation*}
\end{example}
\begin{example}[3(ii) - second example]
    Consider the Elliptic Curve
    \begin{equation*}
        E: y^2 + x y + 2 y = x^3 + 2 x^2
    \end{equation*}
    defined over $\Q$.
    Note that the reduction $\tilde{E}$ modulo $5$ is still an Elliptic Curve (If $3x^2 + y = 2y + 1 + x = 0$ then $y^2 - y - 1 = 0$, so $y = -1$ and $x = 1$. However $(1, -1) \notin \tilde{E}(\F_3)$).
    Trying all values in $\F_3^2$, we find
    \begin{equation*}
        \tilde{E}(\F_3) = \{ (0, 0), (0, 2), \O \} 
    \end{equation*}
    Clearly $E(\Q)$ has the 3-torsion point $(0, 0)$, and since $E_{\mathrm{tors}}(\Q) \hookrightarrow \tilde{E}(\F_3)$ we see that
    \begin{equation*}
        E_{\mathrm{tors}}(\Q) = \{ (0, 0), (0, -1), \O \}
    \end{equation*}
\end{example}

\section{Question 4}
Let $S = \{ x^2 \ | \ x \in \Q^* \}$.
\begin{example}[4(i)]
    \label{ex:4i}
    The Elliptic Curve $E: y^2 = x(x + 6x + 1)$ has rank $0$.
\end{example}
\begin{proof}
    As in the lecture, consider
    \begin{align*}
        &E': y^2 = x(x^2 - 12x + 32) \\
        &\phi: E \to E', \quad (u, v) \mapsto \left( \frac {y^2} {x^2}, \ y \frac {x^2 - 1} {x^2} \right) \\
        &\hat{\phi}: E' \to E, \quad (u, v) \mapsto \left( \frac {y^2} {4x^2}, \ y \frac {x^2 - 1} {8x^2} \right) \\
        &q: E'(\Q)/\phi(E(\Q)) \to \Q^*/S, \quad \overline{(u, v)} \mapsto \begin{cases}
            \overline{u} & \text{if $u \neq 0$} \\
            \overline{32} & \text{if $u = 0$}
        \end{cases} \\
        &\hat{q}: E(\Q)/\phi(E'(\Q)) \to \Q^*/S, \quad \overline{(u, v)} \mapsto \begin{cases}
            \overline{u} & \text{if $u \neq 0$} \\
            \overline{1} & \text{if $u = 0$}
        \end{cases}
    \end{align*}
    To find the rank, we proceed as in the lecture (technically, use \cite[Lemma 6.6]{lecture}).

    \paragraph{Find $E'(\Q)/\phi(E(\Q))$} Consider $r \divides 32$ square-free, i.e. $r \in \{ \pm 1, \pm 2 \}$.

    For $r = 2$, have that $(l, m, n) = (2, 1, 0)$ solves
    \begin{equation*}
        2l^4 - 12l^2m^2 + 16m^4 = n^2
    \end{equation*}
    and indeed we find $(8, 0) \in E'(\Q)$.

    For $r = -1$, note that
    \begin{equation*}
        -l^4 - 12l^2m^2 - 32m^4 = n^2
    \end{equation*}
    has no nontrivial solutions in $\Q$, as the left-hand side is always $\leq 0$ and the right-hand side is $\geq 0$.

    Since $-2 = -1 \cdot 2$, we see that $\im(q) = \langle 2 \rangle$ and $E'(\Q)/\phi(E(\Q)) = \langle (8, 0) \rangle$.

    \paragraph{Find $E(\Q)/\hat{\phi}(E'(\Q))$} Consider $r \divides 1$ square-free, i.e. $r \in \{ \pm 1 \}$.

    For $r = -1$, have that $(l, m, n) = (1, 1, 2)$ solves
    \begin{equation*}
        -l^4 + 6l^2m^2 - m^4 = n^2
    \end{equation*}
    and indeed find $(-1, 2) \in E(\Q)$.

    Thus find $\im(\hat{q}) = \langle -1 \rangle$ and $E(\Q)/\hat{\phi}(E'(\Q)) = \langle (-1, 2) \rangle$.

    \paragraph{Find the rank of $E$} By the above two steps, we see that
    \begin{equation*}
        E(\Q)/[2]E(\Q) = \langle (-1, 2), \hat{\phi}((8, 0)) \rangle = \langle (-1, 2), (0, 0) \rangle
    \end{equation*}
    Now observe that $[2](-1, 2) = (0, 0)$ and $[2](0, 0) = \O$.
    Hence $E(\Q) = E_{\mathrm{tors}}(\Q)$ and the rank is 0 as claimed.
\end{proof}
To find an example with rank two, it seems like a good way to take a curve with many rational points.
Further requiring those points to be non-integral increases our chance, as that way, they cannot be torsion points.
However, playing around with this method did not yield a nice curve for which we can easily compute the rank.
So lets fall back to brute force, which works quite well here as this condition is very easy to test via a computer.
\begin{example}[4(ii)]
    \label{ex:special_curve}
    Consider the curve
    \begin{equation*}
        E: y^2 = x(x^2 + 47 x + 30)
    \end{equation*}
    Clearly $30 = 2 \cdot 3 \cdot 5$ has at least 3 different prime factors.
    We want to compute the rank of $E$.
    As always, have
    \begin{equation*}
        E': y^2 = x(x^2 - 92 x + 2089)
    \end{equation*}

    \paragraph{Find $E'(\Q)/\phi(E(\Q))$} Have $b_1 = 2089$ is prime, so consider $r \in \{ \pm 1, \pm 2098 \}$.
    First note that for $r < 0$, the equation
    \begin{equation*}
        r l^4 - 92 l^2 m^2 + \frac {2089} r m^4 = n^2
    \end{equation*}
    has no real nontrivial solutions, as the left-hand side is $< 0$ and the right-hand side is $\geq 0$.
    Hence, it is left to consider $r = 2089$.
    Notice that the equations
    \begin{equation*}
        2089 l^4 - 92 l^2 m^2 + m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (0, 1, 1)$ and so $E'(\Q)/\phi(E(\Q)) = \langle (0, 0) \rangle$.

    \paragraph{Find $E(\Q)/\hat{\phi}(E'(\Q))$} Have $b = 30 = 2 \cdot 3 \cdot 5$, so consider
    \begin{equation*}
        r \in \{ \pm 1, \pm 2, \pm 3, \pm 5, \pm 6, \pm 10, \pm 15, \pm 30 \}
    \end{equation*}

    The equation
    \begin{equation*}
        -l^4 + 47 l^2 m^2 - 30 m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (1, 1, 4)$ which gives a point $(-1, 4) \in E(\Q)$.

    The equation
    \begin{equation*}
        2l^4 + 47 l^2 m^2 + 15 m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (1, 1, 8)$ which gives a point $(2, 8) \in E(\Q)$.

    The equation
    \begin{equation*}
        3l^4 + 47 l^2 m^2 + 10 m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (3, 1, 26)$ which gives a point $(27, 234) \in E(\Q)$.

    The equation
    \begin{equation*}
        5l^4 + 47 l^2 m^2 + 6m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (1, 2, 17)$ which gives a point $(\frac 5 4, \frac {85} 8)$.

    Since $\im(\hat{q})$ is a group and $-1, 2, 3, 5$ clearly generate
    \begin{equation*}
        \{ \pm 1, \pm 2, \pm 3, \pm 5, \pm 6, \pm 10, \pm 15, \pm 30 \} \subseteq \Q^*/S
    \end{equation*}
    we already see that $\im(\hat{q}) = \langle -1, 2, 3, 5 \rangle$.

    \paragraph{Find the rank of $E$} Combining the above, we see that
    \begin{equation*}
        E(\Q)/[2]E(\Q) = \langle (-1, 4), (2, 8), (27, 234), \left(\frac 5 4, \frac {85} 8\right) \rangle
    \end{equation*}
    since $\hat{\phi}((0, 0)) = \O$.
    This further shows that $E(\Q)/[2]E(\Q) \cong (\Z/2\Z)^4$.
    Note that $x^2 + 47 x + 30$ has no rational root, so $(0, 0)$ is the only nontrivial 2-torsion points and thus
    \begin{equation*}
        E_{\mathrm{tors}}(\Q)/[2]E(\Q) \cong \Z/2\Z
    \end{equation*}
    Hence we see that the rank of $E$ is $4 - 1 = 3 \geq 2$.
\end{example}
Note that the computer also found other, similarly special curves, given by equations\footnote{I should have guessed that there is a solution involving 42.}
\begin{align*}
    E_1: y^2 = x(x^2 + 59 x^2 + 42) \\
    E_2: y^2 = x(x^2 + 83 x^2 + 78)
\end{align*}

\begin{prop}[4(iii)]
    \label{prop:rank_bound}
    Let $E: y^2 = x(x^2 + a x + b)$ be an Elliptic Curve such that $b(a^2 - 4b)$ has exactly $k$ prime factors.
    Then $\mathrm{rank}(E) \leq 2k$.
    Furthermore, we have
    \begin{itemize}
        \item If $a \leq 0, b \geq 0$, then $\mathrm{rank}(E) \leq 2k - 1$
        \item If $a \perp b$ are coprime, then $\mathrm{rank}(E) \leq k$
        \item If $a \perp b$ and $a \leq 0, b \geq 0$, then $\mathrm{rank}(E) \leq k - 1$
    \end{itemize}
    Note that if one of the additional conditions is fulfilled for $a_1, b_1$, then we get the corresponding bound for $\mathrm{rank}(E') = \mathrm{rank}(E)$ 
    (isogenous curves have the same rank, as isogenies are group homomorphisms with finite kernel, see \cite[Thm III.4.8]{silverman} and \cite[Corollary III.4.9]{silverman}).
\end{prop}
\begin{proof}
    Use $a_1, b_1, E', \phi, \hat{\phi}, q, \hat{q}$ as in the lecture.
    Let $l$ denote the number of distinct prime factors of $a^2 - 4b = b_1$ and $m$ denote the number of distinct prime factors of $b$.
    As shown in the lecture, have that $E'(\Q)/\phi(E(\Q)) \cong \im(q)$ and if $\overline{r} \in \im(q)$ with $r \in \Z$ square-free, then $r \divides b_1$.
    Thus
    \begin{equation*}
        \#(E'(\Q)/\phi(E(\Q))) = \#\im(q) \leq \#\{ r \divides b_1 \ | \ r \in \Z \ \text{square-free}\}
    \end{equation*}
    Now observe that there is a bijection
    \begin{equation*}
        \mathfrak{P}(\{ -1 \} \cup \{ p \divides b_1 \ | \ p \ \text{prime}\}) \to \{ r \divides b_1 \ | \ r \in \Z \ \text{square-free} \}, \quad M \mapsto \prod_{x \in M} x
    \end{equation*}
    and so
    \begin{equation*}
        \#(E'(\Q)/\phi(E(\Q))) \leq 2^{l + 1}
    \end{equation*}
    Note that the map $\hat{\phi}$ is a group homomorphism with kernel of size 2, and therefore we find
    \begin{equation*}
        \#(\hat{\phi}(E'(\Q))/[2]E(\Q)) \leq 2^l
    \end{equation*}
    Similarly, find
    \begin{equation*}
        \#(E(\Q)/\hat{\phi}(E'(\Q))) \leq 2^{m + 1}
    \end{equation*}
    Since there is a surjection
    \begin{equation*}
        E(\Q)/\hat{\phi}(E'(\Q)) \oplus \hat{\phi}(E'(\Q))/[2]E(\Q) \to E(\Q)/[2]E(\Q)
    \end{equation*}
    we see that
    \begin{equation}
        \#(E(\Q)/[2]E(\Q)) \leq 2^l \cdot 2^{m + 1} = 2^{l + m + 1} \label{eq:general_bound}
    \end{equation}
    Finally, note that
    \begin{equation*}
        E(\Q)/[2]E(\Q) \cong E_{\mathrm{tors}}(\Q)/[2]E(\Q) \oplus (\Z/2\Z)^{\mathrm{rank}(E)}
    \end{equation*}
    and thus $\Z/2\Z \hookrightarrow E_{\mathrm{tors}}(\Q)/[2]E(\Z)$ (there is the nontrivial 2-torsion point $(0, 0)$)
    This yields
    \begin{equation*}
        \mathrm{rank}(E) \leq \log_2(\#(E(\Z)/[2]E(\Q)) / 2) \leq \log_2(2^{l + m}) = l + m \leq 2k
    \end{equation*}

    \paragraph{Assume $a \leq 0, b \geq 0$} Then the equation
    \begin{equation*}
        r l^4 + a l^2 m^2 + \frac b r = n^2
    \end{equation*}
    has no real nontrivial solutions for $r \leq 0$.
    Since the solutions are in 1-to-1 correspondence with $\im(q)$, we see that
    \begin{equation*}
        \#(E(\Q)/\hat{\phi}(E'(\Q))) = \#\im(\hat{q}) \leq \#\{ r \divides b \ | \ r \in \Z \ \text{positive, square-free} \}
    \end{equation*}
    There is a bijection
    \begin{equation*}
        \mathfrak{P}(\{ p \divides b \ | \ p \ \text{prime} \}) \to \{ r \divides b \ | \ r \in \Z \ \text{positive, square-free} \}, \quad M \mapsto \prod_{x \in M} x
    \end{equation*}
    Thus
    \begin{equation*}
        \#(E(\Q)/\hat{\phi}(E'(\Q))) \leq 2^m
    \end{equation*}
    As before find then (since $\hat{\phi}$ has a kernel of size 2)
    \begin{equation}
        \#(E(\Q)/[2]E(\Q)) \leq 2^l \cdot 2^m \label{eq:sign_bound}
    \end{equation}
    and again as before
    \begin{equation*}
        \mathrm{rank}(E) \leq \log_2(2^l \cdot 2^m / 2) = l + m - 1 \leq 2k - 1
    \end{equation*}

    \paragraph{Assume $a \perp b$} Then have that $b_1 = (a^2 - 4b) \perp b$ and thus we find that $l + m = k$.
    Equation~\ref{eq:general_bound} is
    \begin{equation*}
        \#(E(\Q)/[2]E(\Q)) \leq 2^l \cdot 2^{m + 1} = 2^{l + m + 1}
    \end{equation*}
    and so it follows
    \begin{equation*}
        \mathrm{rank}(E) \leq \log_2(2^{l + m + 1} / 2) = l + m = k
    \end{equation*}

    \paragraph{Assume $a \perp b$ and $a \leq 0, b \geq 0$} Now have both Equation~\ref{eq:sign_bound}
    \begin{equation*}
        \#(E(\Q)/[2]E(\Q)) \leq 2^l \cdot 2^m = 2^{m + l}
    \end{equation*}
    and $m + l = k$.
    As before, it follows
    \begin{equation*}
        \mathrm{rank}(E) \leq \log_2(2^{m + l} / 2) = m + l - 1 = k - 1
    \end{equation*}
\end{proof}
Now we want to examine if the above inequalities are sharp.
\begin{example}
    Consider the curve $E: y^2 = x(x^2 - 6x + 1)$, which satisfies $a \leq 0, b \geq 0$ and $a \perp b$.
    Furthermore, $b_1 = 6^2 - 4 = 32 = 2^5$ has only one prime factor.
    Thus Proposition~\ref{prop:rank_bound} yields that $\mathrm{rank}(E) \leq 0$, so $\mathrm{rank}(E) = 0$.
\end{example}
Note that also Example~\ref{ex:special_curve} gives an example for the sharpness of part (iii), as the dual curve
\begin{equation*}
    E': y^2 = x(x - 92 x + 2089)
\end{equation*}
satisfies $a \leq 0, b \geq 0$ and $a \perp b$, and indeed its rank is $\mathrm{rank}(E') = 3 = 4 - 1$ (note that $2089 \cdot 30$ has exactly $4$ prime factors).

The next example shows that also part (i) of Proposition~\ref{prop:rank_bound} is sharp.
\begin{example}
    Consider the curve $E: y^2 = x(x^2 + 8)$, which satisfies $a \leq 0, b \geq 0$.
    Furthermore, $b b_1 = 8(-4 \cdot 8) = -256$ has only one prime factor.
    Thus Proposition~\ref{prop:rank_bound} yields that $\mathrm{rank}(E) \leq 2 - 1 = 1$.
    We claim that $\mathrm{rank}(E) = 1$.

    As always, have the curve
    \begin{equation*}
        E': y^2 = x(x^2 - 32)
    \end{equation*}
    \paragraph{Find $E'(\Q)/\phi(E(\Q))$} Have $b_1 = -32$, so consider $r \in \{ \pm 1, \pm 2 \}$.
    
    The equation
    \begin{equation*}
        -l^4 + 32m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (2, 1, 4)$ which gives a point $(-4, 8) \in E'(\Q)$.

    The equation
    \begin{equation*}
        2l^4 -16m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (2, 1, 4)$ which gives a point $(8, 16) \in E'(\Q)$.

    Hence also $-2 = -1 \cdot 2 \in \im(q)$ and we see that
    \begin{equation*}
        E'(\Q)/\phi(E(\Q)) = \langle (-4, 4), (8, 16) \rangle
    \end{equation*}

    \paragraph{Find $E(\Q)/\hat{\phi}(E'(\Q))$} Have $b = 8$, so consider $r \in \{ \pm 1, \pm 2 \}$.

    The equation
    \begin{equation*}
        -l^4 - 8m^4 = n^2
    \end{equation*}
    has no solution in $\mathbb{R}$, thus no solution in $\Q$.

    The equation
    \begin{equation*}
        2l^4 + 4m^4 = n^2
    \end{equation*}
    has the solution $(l, m, n) = (0, 1, 2)$ which gives a point $(0, 0) \in E(\Q)$.

    Hence also $-2 = -1 \cdot 2 \notin \im(\hat{q})$ and we see that
    \begin{equation*}
        E(\Q)/\hat{\phi}(E'(\Q)) = \langle \hat{\phi}(-4, 8), \hat{\phi}(8, 16), (0, 0) \rangle = \langle (1, 3), (0, 0) \rangle
    \end{equation*}

    \paragraph{Find the rank of $E$} By the above, have
    \begin{equation*}
        E(\Q)/[2]E(\Q) = \langle (1, 3), (0, 0) \rangle
    \end{equation*}
    Note that the square of the $y$-coordinate $3^2 = 9$ does not divide $\Delta(E) = 4 \cdot 8^3 = 2^{11}$ and so $(1, 3)$ is not torsion by the Nagell-Lutz theorem \cite[Thm 5.4]{lecture}.
    So it is of infinite order, and we have indeed that $\mathrm{rank}(E) = 1$.
\end{example}

\section{Appendix}
The curves from Example~\ref{ex:special_curve} were found by the following python script.
\lstinputlisting[language = python]{4ii_computations.py}

\printbibliography

\end{document}